<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using and understanding a Chromatograms object • Chromatograms</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Using and understanding a Chromatograms object">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Chromatograms</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/creating-backend-classes.html">Creating new `ChromBackend` classes for Chromatograms</a>
    </li>
    <li>
      <a href="../articles/using-a-chromatograms-object.html">Using and understanding a Chromatograms object</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/RforMassSpectrometry/Chromatograms/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Using and understanding a Chromatograms
object</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/RforMassSpectrometry/Chromatograms/blob/main/vignettes/using-a-chromatograms-object.Rmd" class="external-link"><code>vignettes/using-a-chromatograms-object.Rmd</code></a></small>
      <div class="hidden name"><code>using-a-chromatograms-object.Rmd</code></div>

    </div>

    
    
<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function() {
  document.querySelector("h1").className = "title";
});
</script><script type="text/javascript">
document.addEventListener("DOMContentLoaded", function() {
  var links = document.links;  
  for (var i = 0, linksLength = links.length; i < linksLength; i++)
    if (links[i].hostname != window.location.hostname)
      links[i].target = '_blank';
});
</script><p><strong>Package</strong>: Chromatograms 1.1.1 <br><strong>Compiled</strong>: Thu Jan 22 18:34:46 2026</p>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <em>Chromatograms</em> package provides a scalable and flexible
infrastructure to represent, retrieve, and handle chromatographic data.
The <code>Chromatograms</code> object offers a standardized interface to
access and manipulate chromatographic data while supporting various ways
to store and retrieve this data through the concept of exchangeable
<em>backends</em>. This vignette provides general examples and
descriptions for the <em>Chromatograms</em> package.</p>
<p>Contributions to this vignette (content or correction of typos) or
requests for additional details and information are highly welcome,
ideally <em>via</em> pull requests or <em>issues</em> on the package’s
<a href="https://github.com/RforMassSpectrometry/Chromatograms" class="external-link">github
repository</a>.</p>
<p>This vignette describe the structure of a Chromatograms object and
the methods that need to be implemented. In order to see the structure
of the object, the <code>@</code> accessor is used to access the
different slots. This is possible because the <code>Chromatograms</code>
class is defined as an S4 class. However users should not use the
<code>@</code> accessor to access the data stored in a
<code>Chromatograms</code> object, but instead use the methods defined
by the <code>Chromatograms</code> class.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>The package can be installed with the <em>BiocManager</em> package.
To install <em>BiocManager</em>, use
<code>install.packages("BiocManager")</code>, and after that, use
<code>BiocManager::install("Chromatograms")</code> to install
<em>Chromatograms</em>.</p>
</div>
<div class="section level2">
<h2 id="the-chromatograms-object">The Chromatograms object<a class="anchor" aria-label="anchor" href="#the-chromatograms-object"></a>
</h2>
<p>The <code>Chromatograms</code> object is a container for
chromatographic data, which includes peaks data (<em>retention time</em>
and related intensity values, also<br>
referred to as <em>peaks data variables</em> in the context of
<code>Chromatograms</code>) and metadata of individual chromatograms
(so-called <em>chromatogram variables</em>). While a core set of
chromatogram variables (the <code>coreChromatogramsVariables()</code>)
and peaks data variables (the <code><a href="../reference/ChromBackend.html">corePeaksVariables()</a></code>) are
guaranteed to be provided by a <code>Chromatograms</code>, it is
possible to add arbitrary variables to a <code>Chromatograms</code>
object.</p>
<p>The <code>Chromatograms</code> object is designed to contain
chromatographic data for a (large) set of chromatograms. The data is
organized <em>linearly</em> and can be thought of as a list of
chromatograms, where each element in the <code>Chromatograms</code> is
one chromatogram.</p>
<div class="section level3">
<h3 id="available-backends">Available backends<a class="anchor" aria-label="anchor" href="#available-backends"></a>
</h3>
<p>Backends allow to use different <em>backends</em> to store
chromatographic data while providing <em>via</em> the
<code>Chromatograms</code> class a unified interface to use that data.
The <code>Chromatograms</code> package defines a set of example backends
but any object extending the base <code>ChromBackend</code> class could
be used instead. The default backends are:</p>
<ul>
<li><p><code>ChromBackendMemory</code>: the <em>default</em> backend to
store data in memory. Due to its design the
<code>ChromBackendMemory</code> provides fast access to the peaks data
and metadata. Since all data is kept in memory, this backend has a
relatively large memory footprint (depending on the data) and is thus
not suggested for very large experiments.</p></li>
<li><p><code>ChromBackendMzR</code>: this backend keeps only the
chromatographic metadata variables in memory and relies on the <em><a href="https://bioconductor.org/packages/3.23/mzR" class="external-link">mzR</a></em> package
to read chromatographic peaks (retention time and intensity values) from
the original mzML files on-demand.</p></li>
<li><p><code>ChromBackendSpectra</code>: this backend generates
chromatographic data from a <code>Spectra</code> object. It can be used
to create Total Ion Chromatograms (TIC), Base Peak Chromatograms (BPC),
or Extracted Ion Chromatograms (EICs). It supports both in-memory and
file-backed <code>Spectra</code> objects. The backend uses
<strong>factorization</strong> to group spectra into chromatograms based
on variables like MS level and data origin (see details below).</p></li>
</ul>
<p>All backends provide a consistent interface through the
<code>Chromatograms</code> object, regardless of where or how the data
is stored. The <code>ChromBackendSpectra</code> has a special feature:
it uses an internal sort index (<code>spectraSortIndex</code>) to
maintain retention time order without physically reordering the
underlying <code>Spectra</code> object. This is particularly important
for disk-backed <code>Spectra</code> objects, as it avoids loading all
data into memory. The sort index is automatically maintained during
subsetting and factorization operations.</p>
</div>
<div class="section level3">
<h3 id="chromatographic-peaks-data">Chromatographic peaks data<a class="anchor" aria-label="anchor" href="#chromatographic-peaks-data"></a>
</h3>
<p>The <em>peaks data variables</em> information in the
<code>Chromatograms</code> object can be accessed using the
<code><a href="../reference/peaksData.html">peaksData()</a></code> function. <code>peaksData</code> can be
accessed, replaced, and also filtered/subsetted.</p>
<p>The <em>core peaks data variables</em> all have their own accessors
and are as follows:</p>
<ul>
<li>
<code>rtime</code>: A <code>numeric</code> vector containing
retention time values.</li>
<li>
<code>intensity</code>: A <code>numeric</code> vector containing
intensity values.</li>
</ul>
</div>
<div class="section level3">
<h3 id="chromatograms-metadata">Chromatograms metadata<a class="anchor" aria-label="anchor" href="#chromatograms-metadata"></a>
</h3>
<p>The metadata of individual chromatograms (so called <em>chromatograms
variables</em>), can be accessed using the <code><a href="../reference/chromData.html">chromData()</a></code>
function. The <code>chromData</code> can be accessed, replaced, and
filtered.</p>
<p>The <em>core chromatogram variables</em> all have their own accessor
methods, and it is guaranteed that a value is returned by them (or
<code>NA</code> if the information is not available).</p>
<p>The core variables and their data types are (alphabetically
ordered):</p>
<ul>
<li>
<code>chromIndex</code>: an <code>integer</code> with the index of
the chromatogram in the original source file (e.g., <em>mzML</em>
file).</li>
<li>
<code>collisionEnergy</code>: for SRM data, <code>numeric</code>
with the collision energy of the precursor.</li>
<li>
<code>dataOrigin</code>: optional <code>character</code> with the
origin of a chromatogram.</li>
<li>
<code>storageLocation</code>: <code>character</code> defining where
the data is (currently) stored.</li>
<li>
<code>msLevel</code>: <code>integer</code> defining the MS level of
the data.</li>
<li>
<code>mz</code>: optional <code>numeric</code> with the (target) m/z
value for the chromatographic data.</li>
<li>
<code>mzMin</code>: optional <code>numeric</code> with the lower m/z
value of the m/z range in case the data (e.g., an extracted ion
chromatogram EIC) was extracted from a <code>Chromtagorams</code>
object.</li>
<li>
<code>mzMax</code>: optional <code>numeric</code> with the upper m/z
value of the m/z range.</li>
<li>
<code>precursorMz</code>: for SRM data, <code>numeric</code> with
the target m/z of the precursor (parent).</li>
<li>
<code>precursorMzMin</code>: for SRM data, optional
<code>numeric</code> with the lower m/z of the precursor’s isolation
window.</li>
<li>
<code>precursorMzMax</code>: for SRM data, optional
<code>numeric</code> with the upper m/z of the precursor’s isolation
window.</li>
<li>
<code>productMz</code>: for SRM data, <code>numeric</code> with the
target m/z of the product ion.</li>
<li>
<code>productMzMin</code>: for SRM data, optional
<code>numeric</code> with the lower m/z of the product’s isolation
window.</li>
<li>
<code>productMzMax</code>: for SRM data, optional
<code>numeric</code> with the upper m/z of the product’s isolation
window.</li>
</ul>
<p>For details on the individual variables and their getter/setter
functions, see the help for <code>Chromatograms</code>
(<code><a href="../reference/Chromatograms.html">?Chromatograms</a></code>). Also, note that these variables are
suggested but not required to characterize a chromatogram.</p>
</div>
<div class="section level3">
<h3 id="creating-chromatograms-objects">Creating <code>Chromatograms</code> objects<a class="anchor" aria-label="anchor" href="#creating-chromatograms-objects"></a>
</h3>
<p>The simplest way to create a <code>Chromatograms</code> object is by
defining a backend ofchoice, which mainly depends on what type of data
you have, and passing that to the <code>Chromatograms</code> constructor
function. Below we create such an object for a set of 2 chromatograms,
providing their metadata through a data.frame with the MS level, m/z,
and chromatogram index columns, and peaks data. The metadata includes
the MS level, m/z, and chromatogram index, while the peaks data includes
the retention time and intensity in a list of data.frames.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># A data.frame with chromatogram variables.</span></span>
<span><span class="va">cdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    msLevel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">1L</span><span class="op">)</span>,</span>
<span>    mz <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">112.2</span>, <span class="fl">123.3</span><span class="op">)</span>,</span>
<span>    chromIndex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">2L</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Retention time and intensity values for each chromatogram.</span></span>
<span><span class="va">pdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>        rtime <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">11</span>, <span class="fl">12.4</span>, <span class="fl">12.8</span>, <span class="fl">13.2</span>, <span class="fl">14.6</span>, <span class="fl">15.1</span>, <span class="fl">16.5</span><span class="op">)</span>,</span>
<span>        intensity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50.5</span>, <span class="fl">123.3</span>, <span class="fl">153.6</span>, <span class="fl">2354.3</span>, <span class="fl">243.4</span>, <span class="fl">123.4</span>, <span class="fl">83.2</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>        rtime <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">45.1</span>, <span class="fl">46.2</span>, <span class="fl">53</span>, <span class="fl">54.2</span>, <span class="fl">55.3</span>, <span class="fl">56.4</span>, <span class="fl">57.5</span><span class="op">)</span>,</span>
<span>        intensity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">180.1</span>, <span class="fl">300.45</span>, <span class="fl">1400</span>, <span class="fl">1200.3</span>, <span class="fl">300.2</span>, <span class="fl">150.1</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create and initialize the backend</span></span>
<span><span class="va">be</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/backendInitialize.html" class="external-link">backendInitialize</a></span><span class="op">(</span><span class="fu"><a href="../reference/ChromBackendMemory.html">ChromBackendMemory</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    chromData <span class="op">=</span> <span class="va">cdata</span>, peaksData <span class="op">=</span> <span class="va">pdata</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create Chromatograms object</span></span>
<span><span class="va">chr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Chromatograms.html">Chromatograms</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span></span>
<span><span class="va">chr</span></span></code></pre></div>
<pre><code><span><span class="co">## Chromatographic data (Chromatograms) with 2 chromatograms in a ChromBackendMemory backend:</span></span>
<span><span class="co">##   chromIndex msLevel    mz</span></span>
<span><span class="co">## 1          1       1 112.2</span></span>
<span><span class="co">## 2          2       1 123.3</span></span>
<span><span class="co">## ... 0 more  chromatogram variables/columns</span></span>
<span><span class="co">## ... 2 peaksData variables</span></span></code></pre>
<p>Alternatively, it is possible to import chromatograhic data from mass
spectrometry raw files in mzML/mzXML or CDF format. Below, we create a
<code>Chromatograms</code> object from an mzML file and define to use a
<code>ChromBackendMzR</code> backend to <em>store</em> the data (note
that this requires the <em><a href="https://bioconductor.org/packages/3.23/mzR" class="external-link">mzR</a></em> package
to be installed). This backend, specifically designed for raw LC-MS
data, keeps only a subset of chromatogram variables in memory while
reading the retention time and intensity values from the original data
files only on demand. See section <a href="#backends">Backends</a> for
more details on backends and their properties.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MRM_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"proteomics"</span>, <span class="st">"MRM-standmix-5.mzML.gz"</span>,</span>
<span>    package <span class="op">=</span> <span class="st">"msdata"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">be</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/backendInitialize.html" class="external-link">backendInitialize</a></span><span class="op">(</span><span class="fu"><a href="../reference/ChromBackendMzR.html">ChromBackendMzR</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    files <span class="op">=</span> <span class="va">MRM_file</span>,</span>
<span>    BPPARAM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/SerialParam-class.html" class="external-link">SerialParam</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">chr_mzr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Chromatograms.html">Chromatograms</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span></span></code></pre></div>
<p>The <code>Chromatograms</code> object <code>chr_mzr</code> now
contains the chromatograms from the mzML file <code>MRM_file</code>. The
chromatograms can be accessed and manipulated using the
<code>Chromatograms</code> object’s methods and functions.</p>
<p>It is also possible to create a <code>Chromatograms</code> object
directly from a <code>Spectra</code> object. This is particularly useful
when you want to generate total ion chromatograms (TIC), base peak
chromatograms (BPC), or extracted ion chromatograms (EIC) from spectral
data. A worked example is provided in the <a href="#plotting-chromatograms-from-a-spectra-object">plotting</a>
section below.</p>
<p>Basic information about the <code>Chromatograms</code> object can be
accessed using functions such as <code><a href="https://rdrr.io/r/base/length.html" class="external-link">length()</a></code>, which tell us
how many chromatograms are contained in the object:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">chr</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 2</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">chr_mzr</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 138</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="access-data-from-a-chromatograms-object">Access data from a Chromatograms object<a class="anchor" aria-label="anchor" href="#access-data-from-a-chromatograms-object"></a>
</h2>
<p>The <code>Chromatograms</code> object provides a set of methods to
access and manipulate the chromatographic data. The following sections
describe how to do such thingson the peaks data and related
metadata.</p>
<div class="section level3">
<h3 id="peaksdata">peaksData<a class="anchor" aria-label="anchor" href="#peaksdata"></a>
</h3>
<p>The main function to access the full or a part of the peaks data is
<code><a href="../reference/peaksData.html">peaksData()</a></code> (imaginative right), This function returns a
list of data.frames, where each data.frame contains the retention time
and intensity values for one chromatogram. It is used such as below:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/peaksData.html">peaksData</a></span><span class="op">(</span><span class="va">chr</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [[1]]</span></span>
<span><span class="co">##   rtime intensity</span></span>
<span><span class="co">## 1  11.0      50.5</span></span>
<span><span class="co">## 2  12.4     123.3</span></span>
<span><span class="co">## 3  12.8     153.6</span></span>
<span><span class="co">## 4  13.2    2354.3</span></span>
<span><span class="co">## 5  14.6     243.4</span></span>
<span><span class="co">## 6  15.1     123.4</span></span>
<span><span class="co">## 7  16.5      83.2</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[2]]</span></span>
<span><span class="co">##   rtime intensity</span></span>
<span><span class="co">## 1  45.1    100.00</span></span>
<span><span class="co">## 2  46.2    180.10</span></span>
<span><span class="co">## 3  53.0    300.45</span></span>
<span><span class="co">## 4  54.2   1400.00</span></span>
<span><span class="co">## 5  55.3   1200.30</span></span>
<span><span class="co">## 6  56.4    300.20</span></span>
<span><span class="co">## 7  57.5    150.10</span></span></code></pre>
<p>Specific peaks variables can be accessed by either precising the
<code>"columns"</code> parameter in <code><a href="../reference/peaksData.html">peaksData()</a></code> or using
<code>$</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/peaksData.html">peaksData</a></span><span class="op">(</span><span class="va">chr</span>, columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rtime"</span><span class="op">)</span>, drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [[1]]</span></span>
<span><span class="co">## [1] 11.0 12.4 12.8 13.2 14.6 15.1 16.5</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[2]]</span></span>
<span><span class="co">## [1] 45.1 46.2 53.0 54.2 55.3 56.4 57.5</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chr</span><span class="op">$</span><span class="va">rtime</span></span></code></pre></div>
<pre><code><span><span class="co">## [[1]]</span></span>
<span><span class="co">## [1] 11.0 12.4 12.8 13.2 14.6 15.1 16.5</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[2]]</span></span>
<span><span class="co">## [1] 45.1 46.2 53.0 54.2 55.3 56.4 57.5</span></span></code></pre>
<p>The methods above also allows to replace the peaks data. It can
either be the full peaks data:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/peaksData.html">peaksData</a></span><span class="op">(</span><span class="va">chr</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>        rtime <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">7</span><span class="op">)</span>,</span>
<span>        intensity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">7</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>        rtime <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">7</span><span class="op">)</span>,</span>
<span>        intensity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">7</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Or for specific variables:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chr</span><span class="op">$</span><span class="va">rtime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">9</span>, <span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">13</span>, <span class="fl">14</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">9</span>, <span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">13</span>, <span class="fl">14</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The peak data can be therefore accessed, replaced but also
filtered/subsetted. The filtering can be done using the
<code><a href="../reference/peaksData.html">filterPeaksData()</a></code> function. This function filters numerical
peaks data variables based on the specified numerical ranges parameter.
This function does not reduce the number of chromatograms in the object,
but it removes the specified peaks data (e.g., “rtime” and “intensity”
pairs) from the peaksData.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chr_filt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/peaksData.html">filterPeaksData</a></span><span class="op">(</span><span class="va">chr</span>, variables <span class="op">=</span> <span class="st">"rtime"</span>, ranges <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">15</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">chr_filt</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 2</span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">rtime</a></span><span class="op">(</span><span class="va">chr_filt</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 2</span></span></code></pre>
<p>As you can see the number of chromatograms in the
<code>Chromatograms</code> object is not reduced, but the peaks data is
filtered/reduced.</p>
</div>
<div class="section level3">
<h3 id="chromdata">chromData<a class="anchor" aria-label="anchor" href="#chromdata"></a>
</h3>
<p>The main function to access the full chromatographic metadata is
<code><a href="../reference/chromData.html">chromData()</a></code>.This function returns the metadata of the
chromatograms stored in the <code>Chromatograms</code> object. It can be
used as follows:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/chromData.html">chromData</a></span><span class="op">(</span><span class="va">chr</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   msLevel    mz chromIndex collisionEnergy dataOrigin mzMin mzMax precursorMz</span></span>
<span><span class="co">## 1       1 112.2          1              NA       &lt;NA&gt;    NA    NA          NA</span></span>
<span><span class="co">## 2       1 123.3          2              NA       &lt;NA&gt;    NA    NA          NA</span></span>
<span><span class="co">##   precursorMzMin precursorMzMax productMz productMzMin productMzMax</span></span>
<span><span class="co">## 1             NA             NA        NA           NA           NA</span></span>
<span><span class="co">## 2             NA             NA        NA           NA           NA</span></span></code></pre>
<p>Specific chromatogram variables can be accessed by either precising
the <code>"columns"</code> parameter in <code><a href="../reference/chromData.html">chromData()</a></code> or
using <code>$</code>.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/chromData.html">chromData</a></span><span class="op">(</span><span class="va">chr</span>, columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"msLevel"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   msLevel</span></span>
<span><span class="co">## 1       1</span></span>
<span><span class="co">## 2       1</span></span></code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chr</span><span class="op">$</span><span class="va">chromIndex</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1 2</span></span></code></pre>
<p>The metadata can be replaced using the same methods as for the peaks
data.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chr</span><span class="op">$</span><span class="va">msLevel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2L</span>, <span class="fl">2L</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/chromData.html">chromData</a></span><span class="op">(</span><span class="va">chr</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   msLevel    mz chromIndex collisionEnergy dataOrigin mzMin mzMax precursorMz</span></span>
<span><span class="co">## 1       2 112.2          1              NA       &lt;NA&gt;    NA    NA          NA</span></span>
<span><span class="co">## 2       2 123.3          2              NA       &lt;NA&gt;    NA    NA          NA</span></span>
<span><span class="co">##   precursorMzMin precursorMzMax productMz productMzMin productMzMax</span></span>
<span><span class="co">## 1             NA             NA        NA           NA           NA</span></span>
<span><span class="co">## 2             NA             NA        NA           NA           NA</span></span></code></pre>
<p>extra columns can also be added by the user using the <code>$</code>
operator.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chr</span><span class="op">$</span><span class="va">extra</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"extra1"</span>, <span class="st">"extra2"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/chromData.html">chromData</a></span><span class="op">(</span><span class="va">chr</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   msLevel    mz chromIndex collisionEnergy dataOrigin mzMin mzMax precursorMz</span></span>
<span><span class="co">## 1       2 112.2          1              NA       &lt;NA&gt;    NA    NA          NA</span></span>
<span><span class="co">## 2       2 123.3          2              NA       &lt;NA&gt;    NA    NA          NA</span></span>
<span><span class="co">##   precursorMzMin precursorMzMax productMz productMzMin productMzMax  extra</span></span>
<span><span class="co">## 1             NA             NA        NA           NA           NA extra1</span></span>
<span><span class="co">## 2             NA             NA        NA           NA           NA extra2</span></span></code></pre>
<p>As for the peaks data, the filtering can be done using the
<code><a href="../reference/chromData.html">filterChromData()</a></code> function. This function filters the
chromatogram variables based on the specified ranges parameter. However,
contrarily to the peaks data, the filtering <em>does</em> reduces the
number of chromatograms in the object.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chr_filt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/chromData.html">filterChromData</a></span><span class="op">(</span><span class="va">chr</span>,</span>
<span>    variables <span class="op">=</span> <span class="st">"chromIndex"</span>, ranges <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    keep <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">chr_filt</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 2</span></span></code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">chr</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 2</span></span></code></pre>
<p>The number of chromatograms in the <code>Chromatograms</code> object
is reduced.</p>
<p>Note that for <code>ChromBackendSpectra</code>, when you subset the
<code>Chromatograms</code> object, the underlying <code>Spectra</code>
object and its sort index are also properly subset and updated. This
ensures that peak data extraction remains efficient even after
subsetting operations.</p>
<div class="section level4">
<h4 id="re-factorizing-after-metadata-changes">Re-factorizing after metadata changes<a class="anchor" aria-label="anchor" href="#re-factorizing-after-metadata-changes"></a>
</h4>
<p>If you modify the chromatogram metadata (particularly the
factorization columns like <code>msLevel</code> or
<code>dataOrigin</code>), you may need to re-factorize the data to
update the groupings. This can be done using the
<code><a href="../reference/ChromBackend.html">factorize()</a></code> function:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Modify metadata</span></span>
<span><span class="va">chr_s</span><span class="op">$</span><span class="va">msLevel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2L</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">chr_s</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Re-factorize to update the groupings</span></span>
<span><span class="va">chr_s</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ChromBackend.html">factorize</a></span><span class="op">(</span><span class="va">chr_s</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/chromData.html">chromData</a></span><span class="op">(</span><span class="va">chr_s</span><span class="op">)</span></span></code></pre></div>
<p>This recalculates which spectra belong to which chromatograms based
on the updated metadata.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="lazy-processing-and-parallelization">Lazy Processing and Parallelization<a class="anchor" aria-label="anchor" href="#lazy-processing-and-parallelization"></a>
</h2>
<p>The <code>Chromatograms</code> object is designed to be scalable and
flexible. It is therefore possible to perform processing in a lazy
manner, i.e., only when the data is needed, and in a parallelized
way.</p>
<div class="section level3">
<h3 id="processing-queue">Processing queue<a class="anchor" aria-label="anchor" href="#processing-queue"></a>
</h3>
<p>Some functions, such as those that require reading large amounts of
data from source files, are deferred and executed only when the data is
needed. For example, when <code><a href="../reference/peaksData.html">filterPeaksData()</a></code> is applied, it
initially returns the same <code>Chromatograms</code> object as the
input, but the filtering step is stored in the processing queue of the
object. Later, when <code>peaksData</code> is accessed, all stacked
operations are performed, and the updated data is returned.</p>
<p>This approach is particularly important for backends that do not
store data in memory, such as <code>ChromBackendMzR</code>. It ensures
that data is read from the source file only when required, reducing
memory usage. However, loading and processing data in smaller chunks can
further minimize memory demands, allowing efficient handling of large
datasets.</p>
<p>It is possible to add also custom functions to the processing queue
of the object. Such a function can be applicable to both the peaks data
and the chromatogram metadata. Below we demonstrate how to add a custom
function to the processing queue of a <code>Chromatograms</code> object.
Below we define a function that divides the intensities of each peak by
a value which can be passed with argument <code>y</code>.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Define a function that takes the backend as an input, divides the intensity</span></span>
<span><span class="co">## by parameter y and returns it. Note that ... is required in</span></span>
<span><span class="co">## the function's definition.</span></span>
<span><span class="va">divide_intensities</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">intensity</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">intensity</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="va">`/`</span>, <span class="va">y</span><span class="op">)</span></span>
<span>    <span class="va">x</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">## Add the function to the procesing queue</span></span>
<span><span class="va">chr_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/processingQueue.html" class="external-link">addProcessing</a></span><span class="op">(</span><span class="va">chr</span>, <span class="va">divide_intensities</span>, y <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">chr_2</span></span></code></pre></div>
<pre><code><span><span class="co">## Chromatographic data (Chromatograms) with 2 chromatograms in a ChromBackendMemory backend:</span></span>
<span><span class="co">##   chromIndex msLevel    mz</span></span>
<span><span class="co">## 1          1       2 112.2</span></span>
<span><span class="co">## 2          2       2 123.3</span></span>
<span><span class="co">## ... 11 more  chromatogram variables/columns</span></span>
<span><span class="co">## ... 2 peaksData variables</span></span>
<span><span class="co">## Lazy evaluation queue: 1 processing step(s)</span></span></code></pre>
<p>Object <code>chr_2</code> has now 2 processing steps in its lazy
evaluation queue. Calling <code><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">intensity()</a></code> on this object will
now return intensities that are half of the intensities of the original
objects <code>chr</code>.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">intensity</a></span><span class="op">(</span><span class="va">chr_2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [[1]]</span></span>
<span><span class="co">## [1] 0.5 1.0 1.5 2.0 2.5 3.0 3.5</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[2]]</span></span>
<span><span class="co">## [1] 0.5 1.0 1.5 2.0 2.5 3.0 3.5</span></span></code></pre>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">intensity</a></span><span class="op">(</span><span class="va">chr</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [[1]]</span></span>
<span><span class="co">## [1] 1 2 3 4 5 6 7</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[2]]</span></span>
<span><span class="co">## [1] 1 2 3 4 5 6 7</span></span></code></pre>
<p>Finally, for <code>Chromatograms</code> that use a <em>writeable</em>
backend, such as the <code>ChromBackendMemory</code> it is possible to
apply the processing queue to the peak data and write that back to the
data storage with the <code><a href="https://rdrr.io/pkg/ProtGenerics/man/processingQueue.html" class="external-link">applyProcessing()</a></code> function. Below we
use this to make all data manipulations on peak data of the
<code>sps_rep</code> object persistent.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">chr_2</span><span class="op">@</span><span class="va">processingQueue</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1</span></span></code></pre>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chr_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/processingQueue.html" class="external-link">applyProcessing</a></span><span class="op">(</span><span class="va">chr_2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">chr_2</span><span class="op">@</span><span class="va">processingQueue</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0</span></span></code></pre>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chr_2</span></span></code></pre></div>
<pre><code><span><span class="co">## Chromatographic data (Chromatograms) with 2 chromatograms in a ChromBackendMemory backend:</span></span>
<span><span class="co">##   chromIndex msLevel    mz</span></span>
<span><span class="co">## 1          1       2 112.2</span></span>
<span><span class="co">## 2          2       2 123.3</span></span>
<span><span class="co">## ... 11 more  chromatogram variables/columns</span></span>
<span><span class="co">## ... 2 peaksData variables</span></span>
<span><span class="co">## Processing:</span></span>
<span><span class="co">##  Applied processing queue with 1 steps [Thu Jan 22 18:34:51 2026]</span></span></code></pre>
<p>Before <code><a href="https://rdrr.io/pkg/ProtGenerics/man/processingQueue.html" class="external-link">applyProcessing()</a></code> the lazy evaluation queue
contained 2 processing steps, which were then applied to the peak data
and <em>written</em> to the data storage. Note that calling
<code><a href="../reference/hidden_aliases.html">reset()</a></code> <strong>after</strong>
<code><a href="https://rdrr.io/pkg/ProtGenerics/man/processingQueue.html" class="external-link">applyProcessing()</a></code> can no longer <em>restore</em> the
data.</p>
</div>
<div class="section level3">
<h3 id="parallelization">Parallelization<a class="anchor" aria-label="anchor" href="#parallelization"></a>
</h3>
<p>The functions are designed to run in multiple chunks (i.e., pieces)
of the object simultaneously, enabling parallelization. This is achieved
using the <code>BiocParallel</code> package. For
<code>ChromBackendMzR</code>, data is automatically split and processed
by files.</p>
<p>For other backends, chunk-wise processing can be enabled by setting
the <code>processingChunkSize</code> of a <code>Chromatograms</code>
object, which defines the number of chromatograms for which peak data
should be loaded and processed in each iteration. The
<code><a href="https://rdrr.io/pkg/ProtGenerics/man/processingQueue.html" class="external-link">processingChunkFactor()</a></code> function can be used to evaluate
how the data will be split. Below, we use this function to assess how
chunk-wise processing would be performed with two
<code>Chromatograms</code> objects:</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/processingQueue.html" class="external-link">processingChunkFactor</a></span><span class="op">(</span><span class="va">chr</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## factor()</span></span>
<span><span class="co">## Levels:</span></span></code></pre>
<p>For the <code>Chromatograms</code> with the in-memory backend an
empty <code><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor()</a></code> is returned, thus, no chunk-wise processing
will be performed. We next evaluate whether the
<code>Chromatograms</code> with the <code>ChromBackendMzR</code> on-disk
backend would use chunk-wise processing.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/processingQueue.html" class="external-link">processingChunkFactor</a></span><span class="op">(</span><span class="va">chr_mzr</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] /__w/_temp/Library/msdata/proteomics/MRM-standmix-5.mzML.gz</span></span>
<span><span class="co">## [2] /__w/_temp/Library/msdata/proteomics/MRM-standmix-5.mzML.gz</span></span>
<span><span class="co">## [3] /__w/_temp/Library/msdata/proteomics/MRM-standmix-5.mzML.gz</span></span>
<span><span class="co">## [4] /__w/_temp/Library/msdata/proteomics/MRM-standmix-5.mzML.gz</span></span>
<span><span class="co">## [5] /__w/_temp/Library/msdata/proteomics/MRM-standmix-5.mzML.gz</span></span>
<span><span class="co">## [6] /__w/_temp/Library/msdata/proteomics/MRM-standmix-5.mzML.gz</span></span>
<span><span class="co">## Levels: /__w/_temp/Library/msdata/proteomics/MRM-standmix-5.mzML.gz</span></span></code></pre>
<p>Here the factor would on yl be of length 1, meaning that all
chromatograms will be processed in one go. however the length would be
higher if more than one file is used. As this data is quite big (138
chromatograms), we can set the <code>processingChunkSize</code> to 10 to
process the data in chunks of 10 chromatograms.</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/processingQueue.html" class="external-link">processingChunkSize</a></span><span class="op">(</span><span class="va">chr_mzr</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/processingQueue.html" class="external-link">processingChunkFactor</a></span><span class="op">(</span><span class="va">chr_mzr</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  1  2  3  4  5  6  7  8  9 10 11 12 13 14 </span></span>
<span><span class="co">## 10 10 10 10 10 10 10 10 10 10 10 10 10  8</span></span></code></pre>
<p>The <code>Chromatograms</code> with the <code>ChromBackendMzR</code>
backend would now split the data in about equally sized arbitrary chunks
and no longer by original data file. <code>processingChunkSize</code>
thus overrides any splitting suggested by the backend.</p>
<p>While chunk-wise processing reduces the memory demand of operations,
the splitting and merging of the data and results can negatively impact
performance. Thus, small data sets or <code>Chromatograms</code> with
in-memory backends willgenerally not benefit from this type of
processing. For computationally intense operation on the other hand,
chunk-wise processing has the advantage, that chunks can (and will) be
processed in parallel (depending on the parallel processing setup).</p>
</div>
</div>
<div class="section level2">
<h2 id="changing-backend-type">Changing backend type<a class="anchor" aria-label="anchor" href="#changing-backend-type"></a>
</h2>
<p>In the previous sections we learned already that a
<code>Chromatograms</code> object can use different backends for the
actual data handling. It is also possible to change the backend of a
<code>Chromatograms</code> to a different one with the
<code><a href="https://rdrr.io/pkg/ProtGenerics/man/backendInitialize.html" class="external-link">setBackend()</a></code> function. As of now it is only possible to
change the <code>ChrombackendMzR</code> to an in-memory backend such as
<code>ChromBackendMemory</code>.</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/object.size.html" class="external-link">object.size</a></span><span class="op">(</span><span class="va">chr_mzr</span><span class="op">)</span>, units <span class="op">=</span> <span class="st">"Mb"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 0.1 Mb</span></span></code></pre>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chr_mzr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/backendInitialize.html" class="external-link">setBackend</a></span><span class="op">(</span><span class="va">chr_mzr</span>, <span class="fu"><a href="../reference/ChromBackendMemory.html">ChromBackendMemory</a></span><span class="op">(</span><span class="op">)</span>, BPPARAM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/SerialParam-class.html" class="external-link">SerialParam</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">chr_mzr</span></span></code></pre></div>
<pre><code><span><span class="co">## Chromatographic data (Chromatograms) with 138 chromatograms in a ChromBackendMemory backend:</span></span>
<span><span class="co">##   chromIndex msLevel mz</span></span>
<span><span class="co">## 1          1      NA NA</span></span>
<span><span class="co">## 2          2      NA NA</span></span>
<span><span class="co">## 3          3      NA NA</span></span>
<span><span class="co">## 4          4      NA NA</span></span>
<span><span class="co">## 5          5      NA NA</span></span>
<span><span class="co">## 6          6      NA NA</span></span>
<span><span class="co">## ... 6 more  chromatogram variables/columns</span></span>
<span><span class="co">## ... 2 peaksData variables</span></span>
<span><span class="co">## Processing:</span></span>
<span><span class="co">##  Switch backend from ChromBackendMzR to ChromBackendMemory [Thu Jan 22 18:34:52 2026]</span></span></code></pre>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chr_mzr</span><span class="op">@</span><span class="va">backend</span><span class="op">@</span><span class="va">peaksData</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># data is now in memory</span></span></code></pre></div>
<pre><code><span><span class="co">##          rtime intensity</span></span>
<span><span class="co">## 1 1.666667e-05  45.37833</span></span>
<span><span class="co">## 2 4.233333e-03  44.39301</span></span>
<span><span class="co">## 3 8.450000e-03  45.33704</span></span>
<span><span class="co">## 4 1.266667e-02  44.30909</span></span>
<span><span class="co">## 5 1.686667e-02  45.40231</span></span>
<span><span class="co">## 6 2.108333e-02  44.29813</span></span></code></pre>
<p>With the call the full peak data was imported from the original mzML
files into the object. This has obviously an impact on the object’s
size, which is now much larger than before.</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/object.size.html" class="external-link">object.size</a></span><span class="op">(</span><span class="va">chr_mzr</span><span class="op">)</span>, units <span class="op">=</span> <span class="st">"Mb"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 2.8 Mb</span></span></code></pre>
<div class="section level3">
<h3 id="choosing-the-right-backend">Choosing the right backend<a class="anchor" aria-label="anchor" href="#choosing-the-right-backend"></a>
</h3>
<p>Different backends are suited for different use cases:</p>
<ul>
<li><p><strong><code>ChromBackendMemory</code></strong>: Best for small
to medium datasets where fast access is needed. All data is kept in
memory, providing the fastest access but higher memory
consumption.</p></li>
<li><p><strong><code>ChromBackendMzR</code></strong>: Ideal for large
datasets stored in mzML/mzXML/CDF files. Only metadata is kept in
memory, while peak data is read on-demand, significantly reducing memory
footprint at the cost of slower data access.</p></li>
<li><p><strong><code>ChromBackendSpectra</code></strong>: Perfect for
generating chromatograms from spectral data, especially when creating
TICs, BPCs, or EICs from existing <code>Spectra</code> objects. The
backend intelligently handles both in-memory and disk-backed
<code>Spectra</code> objects through its internal sorting mechanism,
avoiding unnecessary memory consumption while maintaining good
performance.</p></li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="plotting-chromatograms-from-a-spectra-object">Plotting chromatograms from a <code>Spectra</code> object<a class="anchor" aria-label="anchor" href="#plotting-chromatograms-from-a-spectra-object"></a>
</h2>
<p>For this purpose let’s create a lightweight in-memory
<code>Spectra</code> object and derive a <code>Chromatograms</code> from
it. This avoids any external downloads while still illustrating the
<code>ChromBackendSpectra</code> workflow.</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RforMassSpectrometry/Spectra" class="external-link">Spectra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/IRanges" class="external-link">IRanges</a></span><span class="op">)</span></span>
<span><span class="va">sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Spectra/man/Spectra.html" class="external-link">Spectra</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/DataFrame-class.html" class="external-link">DataFrame</a></span><span class="op">(</span></span>
<span>    rtime <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">110</span>, <span class="fl">120</span>, <span class="fl">130</span>, <span class="fl">140</span><span class="op">)</span>,</span>
<span>    msLevel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">1L</span>, <span class="fl">1L</span>, <span class="fl">1L</span>, <span class="fl">1L</span><span class="op">)</span>,</span>
<span>    dataOrigin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"example"</span>, <span class="fl">5L</span><span class="op">)</span>,</span>
<span>    mz <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/IRanges/man/AtomicList-class.html" class="external-link">NumericList</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">101</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">101</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">101</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">101</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">101</span><span class="op">)</span>,</span>
<span>      compress <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span>,</span>
<span>    intensity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/IRanges/man/AtomicList-class.html" class="external-link">NumericList</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">25</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">18</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">40</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>      compress <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  source <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/Spectra/man/MsBackend.html" class="external-link">MsBackendDataFrame</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">chr_s</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Chromatograms.html">Chromatograms</a></span><span class="op">(</span><span class="va">sp</span><span class="op">)</span></span></code></pre></div>
<p>We now have a <code>Chromatograms</code> object <code>chr_s</code>
with a <code>ChromBackendSpectra</code> backend. one chromatogram was
generated per file.</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chr_s</span></span></code></pre></div>
<pre><code><span><span class="co">## Chromatographic data (Chromatograms) with 1 chromatograms in a ChromBackendSpectra backend:</span></span>
<span><span class="co">##   chromIndex msLevel  mz</span></span>
<span><span class="co">## 1         NA       1 Inf</span></span>
<span><span class="co">## ... 6 more  chromatogram variables/columns</span></span>
<span><span class="co">## ... 2 peaksData variables</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## The Spectra object contains 5 spectra</span></span></code></pre>
<p>The <code>ChromBackendSpectra</code> backend provides flexibility in
how chromatograms are generated from spectral data through a process
called <strong>factorization</strong>.</p>
<div class="section level3">
<h3 id="understanding-factorization">Understanding Factorization<a class="anchor" aria-label="anchor" href="#understanding-factorization"></a>
</h3>
<p>Factorization is the process of grouping individual spectra into
chromatograms based on one or more variables. Think of it as creating
separate “bins” where each bin becomes one chromatogram.</p>
<p>By default, the <code>factorize.by</code> parameter is set to
<code>c("msLevel", "dataOrigin")</code>, which means:</p>
<ul>
<li>All MS1 spectra from file “A” → Chromatogram 1</li>
<li>All MS2 spectra from file “A” → Chromatogram 2</li>
<li>All MS1 spectra from file “B” → Chromatogram 3</li>
<li>All MS2 spectra from file “B” → Chromatogram 4</li>
</ul>
<p>Each unique combination of the factorization variables creates a
separate chromatogram. This allows you to organize your spectral data
into meaningful chromatographic traces that can be visualized and
analyzed together.</p>
<p>You can customize the factorization behavior by changing the
<code>factorize.by</code> parameter. For example, using only
<code>factorize.by = "dataOrigin"</code> would create one chromatogram
per file (combining all MS levels), while adding more variables would
create more granular groupings.</p>
<p>Additionally, you can provide custom chromatogram metadata to define
specific m/z and retention time ranges:</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create custom metadata for EIC extraction</span></span>
<span><span class="va">custom_cd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    msLevel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">1L</span><span class="op">)</span>,</span>
<span>    dataOrigin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="../reference/chromData.html">dataOrigin</a></span><span class="op">(</span><span class="va">sp</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    mzMin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">200</span><span class="op">)</span>,</span>
<span>    mzMax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100.5</span>, <span class="fl">200.5</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">chr_custom</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Chromatograms.html">Chromatograms</a></span><span class="op">(</span><span class="va">sp</span>, chromData <span class="op">=</span> <span class="va">custom_cd</span><span class="op">)</span></span>
<span><span class="va">chr_custom</span></span></code></pre></div>
<pre><code><span><span class="co">## Chromatographic data (Chromatograms) with 2 chromatograms in a ChromBackendSpectra backend:</span></span>
<span><span class="co">##   chromIndex msLevel mz</span></span>
<span><span class="co">## 1         NA       1 NA</span></span>
<span><span class="co">## 2         NA       1 NA</span></span>
<span><span class="co">## ... 6 more  chromatogram variables/columns</span></span>
<span><span class="co">## ... 2 peaksData variables</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## The Spectra object contains 5 spectra</span></span></code></pre>
<p>This approach allows you to pre-define the chromatographic regions
you want to extract, which is useful for targeted analysis
workflows.</p>
<p>Now, let’s say we want to plot specific area of the
chromatograms.</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/chromData.html">chromData</a></span><span class="op">(</span><span class="va">chr_s</span><span class="op">)</span><span class="op">$</span><span class="va">rtmin</span> <span class="op">&lt;-</span> <span class="fl">125</span></span>
<span><span class="fu"><a href="../reference/chromData.html">chromData</a></span><span class="op">(</span><span class="va">chr_s</span><span class="op">)</span><span class="op">$</span><span class="va">rtmax</span> <span class="op">&lt;-</span> <span class="fl">180</span></span>
<span><span class="fu"><a href="../reference/chromData.html">chromData</a></span><span class="op">(</span><span class="va">chr_s</span><span class="op">)</span><span class="op">$</span><span class="va">mzmin</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="fu"><a href="../reference/chromData.html">chromData</a></span><span class="op">(</span><span class="va">chr_s</span><span class="op">)</span><span class="op">$</span><span class="va">mzmax</span> <span class="op">&lt;-</span> <span class="fl">100.5</span></span></code></pre></div>
<p>The <code>Chromatograms</code> object provides a set of functions to
plot the chromatograms and their peaks data. The
<code><a href="../reference/plotChromatograms.html">plotChromatograms()</a></code> function can be used to plot each
single chromatograms into its own plot.</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">RColorBrewer</span><span class="op">)</span></span>
<span><span class="va">col3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">3</span>, <span class="st">"Dark2"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plotChromatograms.html">plotChromatograms</a></span><span class="op">(</span><span class="va">chr_s</span>, col <span class="op">=</span> <span class="va">col3</span><span class="op">)</span></span></code></pre></div>
<p><img src="using-a-chromatograms-object_files/figure-html/unnamed-chunk-25-1.png" class="r-plt" alt="" width="700"></p>
<p>On the overhand if the users wants to easily compare the
chromatograms, the <code><a href="../reference/plotChromatograms.html">plotChromatogramsOverlay()</a></code> function can
be used to overlay all chromatograms into one plot.</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotChromatograms.html">plotChromatogramsOverlay</a></span><span class="op">(</span><span class="va">chr_s</span>, col <span class="op">=</span> <span class="va">col3</span><span class="op">)</span></span></code></pre></div>
<p><img src="using-a-chromatograms-object_files/figure-html/unnamed-chunk-26-1.png" class="r-plt" alt="" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="extracting-chromatographic-regions-of-interest">Extracting chromatographic regions of interest<a class="anchor" aria-label="anchor" href="#extracting-chromatographic-regions-of-interest"></a>
</h2>
<p>The <code><a href="../reference/Chromatograms.html">chromExtract()</a></code> function allows you to extract
specific regions of interest from a <code>Chromatograms</code> object
based on a peak table. This is particularly useful when you want to
focus on specific retention time windows or m/z ranges that correspond
to detected peaks or features of interest.</p>
<div class="section level3">
<h3 id="basic-extraction-by-retention-time">Basic extraction by retention time<a class="anchor" aria-label="anchor" href="#basic-extraction-by-retention-time"></a>
</h3>
<p>For backends like <code>ChromBackendMemory</code> and
<code>ChromBackendMzR</code>, you can extract regions based on retention
time ranges:</p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Define peaks of interest with retention time windows</span></span>
<span><span class="va">peak_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    rtMin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">11</span><span class="op">)</span>,</span>
<span>    rtMax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">13</span><span class="op">)</span>,</span>
<span>    msLevel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2L</span>, <span class="fl">2L</span><span class="op">)</span>,</span>
<span>    chromIndex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">2L</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Extract those regions</span></span>
<span><span class="va">chr_extracted</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Chromatograms.html">chromExtract</a></span><span class="op">(</span><span class="va">chr</span>, <span class="va">peak_table</span>,</span>
<span>                              by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"msLevel"</span>, <span class="st">"chromIndex"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">chr_extracted</span></span></code></pre></div>
<pre><code><span><span class="co">## Chromatographic data (Chromatograms) with 2 chromatograms in a ChromBackendMemory backend:</span></span>
<span><span class="co">##   chromIndex msLevel    mz</span></span>
<span><span class="co">## 1          1       2 112.2</span></span>
<span><span class="co">## 2          2       2 123.3</span></span>
<span><span class="co">## ... 3 more  chromatogram variables/columns</span></span>
<span><span class="co">## ... 2 peaksData variables</span></span></code></pre>
<p>The resulting <code>Chromatograms</code> object contains only the
data within the specified retention time windows. Note that extra
columns in <code>peak_table</code> are added to the chromatogram
metadata:</p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/chromData.html">chromData</a></span><span class="op">(</span><span class="va">chr_extracted</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   msLevel    mz chromIndex  extra rtMin rtMax collisionEnergy dataOrigin mzMin</span></span>
<span><span class="co">## 1       2 112.2          1 extra1     8    10              NA       &lt;NA&gt;    NA</span></span>
<span><span class="co">## 2       2 123.3          2 extra2    11    13              NA       &lt;NA&gt;    NA</span></span>
<span><span class="co">##   mzMax precursorMz precursorMzMin precursorMzMax productMz productMzMin</span></span>
<span><span class="co">## 1    NA          NA             NA             NA        NA           NA</span></span>
<span><span class="co">## 2    NA          NA             NA             NA        NA           NA</span></span>
<span><span class="co">##   productMzMax</span></span>
<span><span class="co">## 1           NA</span></span>
<span><span class="co">## 2           NA</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="extraction-with-mz-filtering-chrombackendspectra-only">Extraction with m/z filtering (ChromBackendSpectra only)<a class="anchor" aria-label="anchor" href="#extraction-with-mz-filtering-chrombackendspectra-only"></a>
</h3>
<p>When using <code>ChromBackendSpectra</code>, you can also filter by
m/z ranges, which is useful for extracting ion chromatograms (EICs) for
specific mass windows:</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Define peak table with both retention time and m/z windows</span></span>
<span><span class="va">peak_table_mz</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    rtMin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">125</span>, <span class="fl">125</span><span class="op">)</span>,</span>
<span>    rtMax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">180</span>, <span class="fl">180</span><span class="op">)</span>,</span>
<span>    mzMin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">140</span><span class="op">)</span>,</span>
<span>    mzMax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100.5</span>, <span class="fl">140.5</span><span class="op">)</span>,</span>
<span>    msLevel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">1L</span><span class="op">)</span>,</span>
<span>    dataOrigin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="../reference/chromData.html">dataOrigin</a></span><span class="op">(</span><span class="va">chr_s</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    featureID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"feature_1"</span>, <span class="st">"feature_2"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Extract EICs for these features</span></span>
<span><span class="va">chr_eics</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Chromatograms.html">chromExtract</a></span><span class="op">(</span><span class="va">chr_s</span>, <span class="va">peak_table_mz</span>,</span>
<span>                        by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"msLevel"</span>, <span class="st">"dataOrigin"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">chr_eics</span></span></code></pre></div>
<pre><code><span><span class="co">## Chromatographic data (Chromatograms) with 2 chromatograms in a ChromBackendSpectra backend:</span></span>
<span><span class="co">##   chromIndex msLevel  mz</span></span>
<span><span class="co">## 1         NA       1 Inf</span></span>
<span><span class="co">## 2         NA       1 Inf</span></span>
<span><span class="co">## ... 18 more  chromatogram variables/columns</span></span>
<span><span class="co">## ... 2 peaksData variables</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## The Spectra object contains 5 spectra</span></span></code></pre>
<p>Notice that the custom column <code>featureID</code> from the peak
table is now part of the chromatogram metadata:</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/chromData.html">chromData</a></span><span class="op">(</span><span class="va">chr_eics</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   msLevel rtMin rtMax mzMin mzMax  mz dataOrigin chromSpectraIndex chromIndex</span></span>
<span><span class="co">## 1       1   125   180   100 100.5 Inf    example         1_example         NA</span></span>
<span><span class="co">## 2       1   125   180   140 140.5 Inf    example         1_example         NA</span></span>
<span><span class="co">##   collisionEnergy precursorMz precursorMzMin precursorMzMax productMz</span></span>
<span><span class="co">## 1              NA          NA             NA             NA        NA</span></span>
<span><span class="co">## 2              NA          NA             NA             NA        NA</span></span>
<span><span class="co">##   productMzMin productMzMax rtmin rtmax mzmin mzmax featureID</span></span>
<span><span class="co">## 1           NA           NA   125   180   100 100.5 feature_1</span></span>
<span><span class="co">## 2           NA           NA   125   180   100 100.5 feature_2</span></span></code></pre>
<p>This is particularly useful for linking extracted chromatograms back
to feature tables or peak detection results.</p>
</div>
</div>
<div class="section level2">
<h2 id="imputing-missing-values-in-chromatograms">Imputing missing values in chromatograms<a class="anchor" aria-label="anchor" href="#imputing-missing-values-in-chromatograms"></a>
</h2>
<p>Real chromatographic data often has gaps or missing intensity values
at certain retention times, which can occur due to instrumental
limitations, data processing artifacts, or sparse sampling. The
<code><a href="../reference/peaksData.html">imputePeaksData()</a></code> function provides several methods to
interpolate these missing values, which can improve downstream analysis
and visualization.</p>
<div class="section level3">
<h3 id="available-imputation-methods">Available imputation methods<a class="anchor" aria-label="anchor" href="#available-imputation-methods"></a>
</h3>
<p>The package provides four imputation methods:</p>
<ul>
<li>
<strong>“linear”</strong>: Linear interpolation between known
values. Fast and simple, good for data with regular gaps.</li>
<li>
<strong>“spline”</strong>: Cubic spline interpolation. Provides
smooth curves but may introduce artifacts.</li>
<li>
<strong>“gaussian”</strong>: Gaussian kernel smoothing. Uses a
Gaussian kernel to estimate values based on neighboring points.</li>
<li>
<strong>“loess”</strong>: Locally weighted scatter plot smoothing.
Provides robust smoothing with local polynomial regression.</li>
</ul>
</div>
<div class="section level3">
<h3 id="example-imputing-an-extracted-ion-chromatogram-eic">Example: Imputing an extracted ion chromatogram (EIC)<a class="anchor" aria-label="anchor" href="#example-imputing-an-extracted-ion-chromatogram-eic"></a>
</h3>
<p>Let’s extract a narrow m/z range EIC and then apply different
imputation methods:</p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create a specific EIC</span></span>
<span><span class="va">eic_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    rtMin <span class="op">=</span> <span class="fl">125</span>,</span>
<span>    rtMax <span class="op">=</span> <span class="fl">180</span>,</span>
<span>    mzMin <span class="op">=</span> <span class="fl">100.01</span>,</span>
<span>    mzMax <span class="op">=</span> <span class="fl">100.02</span>,</span>
<span>    msLevel <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>    dataOrigin <span class="op">=</span> <span class="fu"><a href="../reference/chromData.html">dataOrigin</a></span><span class="op">(</span><span class="va">chr_s</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">chr_eic</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Chromatograms.html">chromExtract</a></span><span class="op">(</span><span class="va">chr_s</span>, <span class="va">eic_table</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"msLevel"</span>, <span class="st">"dataOrigin"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">chr_eic</span></span></code></pre></div>
<pre><code><span><span class="co">## Chromatographic data (Chromatograms) with 1 chromatograms in a ChromBackendSpectra backend:</span></span>
<span><span class="co">##   chromIndex msLevel  mz</span></span>
<span><span class="co">## 1         NA       1 Inf</span></span>
<span><span class="co">## ... 17 more  chromatogram variables/columns</span></span>
<span><span class="co">## ... 2 peaksData variables</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## The Spectra object contains 5 spectra</span></span></code></pre>
<p>Now let’s examine the raw data and apply different imputation
methods:</p>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create copies for comparison</span></span>
<span><span class="va">chr_linear</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/peaksData.html">imputePeaksData</a></span><span class="op">(</span><span class="va">chr_eic</span>, method <span class="op">=</span> <span class="st">"linear"</span><span class="op">)</span></span>
<span><span class="va">chr_spline</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/peaksData.html">imputePeaksData</a></span><span class="op">(</span><span class="va">chr_eic</span>, method <span class="op">=</span> <span class="st">"spline"</span><span class="op">)</span></span>
<span><span class="va">chr_gaussian</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/peaksData.html">imputePeaksData</a></span><span class="op">(</span><span class="va">chr_eic</span>, method <span class="op">=</span> <span class="st">"gaussian"</span>,</span>
<span>                                window <span class="op">=</span> <span class="fl">5</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">chr_loess</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/peaksData.html">imputePeaksData</a></span><span class="op">(</span><span class="va">chr_eic</span>, method <span class="op">=</span> <span class="st">"loess"</span>, span <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Plot all methods for comparison</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Original data</span></span>
<span><span class="fu"><a href="../reference/plotChromatograms.html">plotChromatograms</a></span><span class="op">(</span><span class="va">chr_eic</span>, main <span class="op">=</span> <span class="st">"Original EIC"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in max(abs(ints), na.rm = TRUE): no non-missing arguments to max;</span></span>
<span><span class="co">## returning -Inf</span></span></code></pre>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Linear interpolation</span></span>
<span><span class="fu"><a href="../reference/plotChromatograms.html">plotChromatograms</a></span><span class="op">(</span><span class="va">chr_linear</span>, main <span class="op">=</span> <span class="st">"Linear Imputation"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## The `peaksData` slot will be modified but the changes will not affect the Spectra object.</span></span></code></pre>
<pre><code><span><span class="co">## Warning in max(abs(ints), na.rm = TRUE): no non-missing arguments to max;</span></span>
<span><span class="co">## returning -Inf</span></span></code></pre>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Spline interpolation</span></span>
<span><span class="fu"><a href="../reference/plotChromatograms.html">plotChromatograms</a></span><span class="op">(</span><span class="va">chr_spline</span>, main <span class="op">=</span> <span class="st">"Spline Imputation"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## The `peaksData` slot will be modified but the changes will not affect the Spectra object.</span></span></code></pre>
<pre><code><span><span class="co">## Warning in max(abs(ints), na.rm = TRUE): no non-missing arguments to max;</span></span>
<span><span class="co">## returning -Inf</span></span></code></pre>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Gaussian smoothing</span></span>
<span><span class="fu"><a href="../reference/plotChromatograms.html">plotChromatograms</a></span><span class="op">(</span><span class="va">chr_gaussian</span>, main <span class="op">=</span> <span class="st">"Gaussian Smoothing (window=5, sd=2)"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## The `peaksData` slot will be modified but the changes will not affect the Spectra object.</span></span></code></pre>
<pre><code><span><span class="co">## Warning in max(abs(ints), na.rm = TRUE): no non-missing arguments to max;</span></span>
<span><span class="co">## returning -Inf</span></span></code></pre>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## LOESS smoothing</span></span>
<span><span class="fu"><a href="../reference/plotChromatograms.html">plotChromatograms</a></span><span class="op">(</span><span class="va">chr_loess</span>, main <span class="op">=</span> <span class="st">"LOESS Smoothing (span=0.3)"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## The `peaksData` slot will be modified but the changes will not affect the Spectra object.</span></span></code></pre>
<pre><code><span><span class="co">## Warning in max(abs(ints), na.rm = TRUE): no non-missing arguments to max;</span></span>
<span><span class="co">## returning -Inf</span></span></code></pre>
<p><img src="using-a-chromatograms-object_files/figure-html/unnamed-chunk-32-1.png" class="r-plt" alt="" width="768"></p>
</div>
<div class="section level3">
<h3 id="selecting-the-right-imputation-method">Selecting the right imputation method<a class="anchor" aria-label="anchor" href="#selecting-the-right-imputation-method"></a>
</h3>
<p>The choice of imputation method depends on your data characteristics
and analysis goals:</p>
<ul>
<li>Use <strong>“linear”</strong> for quick interpolation of small gaps
in regularly sampled data.</li>
<li>Use <strong>“spline”</strong> for smooth curves when data is fairly
regular, but be aware it can overshoot.</li>
<li>Use <strong>“gaussian”</strong> for local smoothing that preserves
peak shapes while filling gaps.</li>
<li>Use <strong>“loess”</strong> when you want robust smoothing that
adapts to local data density.</li>
</ul>
</div>
<div class="section level3">
<h3 id="imputation-in-lazy-evaluation-pipelines">Imputation in lazy evaluation pipelines<a class="anchor" aria-label="anchor" href="#imputation-in-lazy-evaluation-pipelines"></a>
</h3>
<p>For on-disk backends like <code>ChromBackendMzR</code>, imputation is
particularly useful when combined with the lazy evaluation queue. The
imputation function is added to the processing queue and is only applied
when peak data is actually accessed:</p>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## For on-disk backends, add imputation to the lazy queue</span></span>
<span><span class="va">chr_mzr_imputed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/peaksData.html">imputePeaksData</a></span><span class="op">(</span></span>
<span>  <span class="va">chr_mzr</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"gaussian"</span>,</span>
<span>  window <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  sd <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">chr_mzr_imputed</span></span></code></pre></div>
<pre><code><span><span class="co">## Chromatographic data (Chromatograms) with 138 chromatograms in a ChromBackendMemory backend:</span></span>
<span><span class="co">##   chromIndex msLevel mz</span></span>
<span><span class="co">## 1          1      NA NA</span></span>
<span><span class="co">## 2          2      NA NA</span></span>
<span><span class="co">## 3          3      NA NA</span></span>
<span><span class="co">## 4          4      NA NA</span></span>
<span><span class="co">## 5          5      NA NA</span></span>
<span><span class="co">## 6          6      NA NA</span></span>
<span><span class="co">## ... 6 more  chromatogram variables/columns</span></span>
<span><span class="co">## ... 2 peaksData variables</span></span>
<span><span class="co">## Lazy evaluation queue: 1 processing step(s)</span></span>
<span><span class="co">## Processing:</span></span>
<span><span class="co">##  Switch backend from ChromBackendMzR to ChromBackendMemory [Thu Jan 22 18:34:52 2026]</span></span>
<span><span class="co">##  Impute: replace missing peaks data using the 'gaussian' method [Thu Jan 22 18:34:54 2026]</span></span></code></pre>
<p>The imputation is <strong>not</strong> performed immediately.
Instead, it’s stored in the processing queue. When you call
<code><a href="../reference/peaksData.html">peaksData()</a></code> on the object, the raw data is read from the
file and then imputation is applied on-the-fly:</p>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## This reads from disk and applies imputation in one step</span></span>
<span><span class="va">peak_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/peaksData.html">peaksData</a></span><span class="op">(</span><span class="va">chr_mzr_imputed</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>This approach is highly efficient for large datasets because:</p>
<ol style="list-style-type: decimal">
<li>Data is only read from disk when needed</li>
<li>Imputation is applied on-the-fly during data access</li>
<li>No temporary files are created</li>
<li>Memory usage remains minimal</li>
</ol>
<p>You can verify the processing queue contains your imputation
step:</p>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">chr_mzr_imputed</span><span class="op">@</span><span class="va">processingQueue</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1</span></span></code></pre>
<p>And if you want to make the imputation permanent (for in-memory
backends), use <code><a href="https://rdrr.io/pkg/ProtGenerics/man/processingQueue.html" class="external-link">applyProcessing()</a></code>:</p>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## For in-memory backends, you can persist the imputation</span></span>
<span><span class="va">chr_in_memory</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/backendInitialize.html" class="external-link">setBackend</a></span><span class="op">(</span><span class="va">chr_mzr_imputed</span>, <span class="fu"><a href="../reference/ChromBackendMemory.html">ChromBackendMemory</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">chr_in_memory</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/processingQueue.html" class="external-link">applyProcessing</a></span><span class="op">(</span><span class="va">chr_in_memory</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Now imputation is permanently applied</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">chr_in_memory</span><span class="op">@</span><span class="va">processingQueue</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="session-information">Session information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R Under development (unstable) (2026-01-18 r89306)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">## Running under: Ubuntu 24.04.3 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span><span class="co">##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co">## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: UTC</span></span>
<span><span class="co">## tzcode source: system (glibc)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats4    stats     graphics  grDevices utils     datasets  methods  </span></span>
<span><span class="co">## [8] base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">##  [1] RColorBrewer_1.1-3  IRanges_2.45.0      Spectra_1.21.1     </span></span>
<span><span class="co">##  [4] S4Vectors_0.49.0    BiocGenerics_0.57.0 generics_0.1.4     </span></span>
<span><span class="co">##  [7] Chromatograms_1.1.1 ProtGenerics_1.43.0 BiocParallel_1.45.0</span></span>
<span><span class="co">## [10] BiocStyle_2.39.0   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] jsonlite_2.0.0         compiler_4.6.0         BiocManager_1.30.27   </span></span>
<span><span class="co">##  [4] Rcpp_1.1.1             Biobase_2.71.0         parallel_4.6.0        </span></span>
<span><span class="co">##  [7] cluster_2.1.8.1        jquerylib_0.1.4        systemfonts_1.3.1     </span></span>
<span><span class="co">## [10] textshaping_1.0.4      yaml_2.3.12            fastmap_1.2.0         </span></span>
<span><span class="co">## [13] R6_2.6.1               knitr_1.51             htmlwidgets_1.6.4     </span></span>
<span><span class="co">## [16] MASS_7.3-65            bookdown_0.46          desc_1.4.3            </span></span>
<span><span class="co">## [19] bslib_0.9.0            rlang_1.1.7            cachem_1.1.0          </span></span>
<span><span class="co">## [22] xfun_0.56              fs_1.6.6               MsCoreUtils_1.23.2    </span></span>
<span><span class="co">## [25] sass_0.4.10            otel_0.2.0             cli_3.6.5             </span></span>
<span><span class="co">## [28] pkgdown_2.2.0.9000     ncdf4_1.24             digest_0.6.39         </span></span>
<span><span class="co">## [31] mzR_2.45.0             MetaboCoreUtils_1.19.1 lifecycle_1.0.5       </span></span>
<span><span class="co">## [34] clue_0.3-66            evaluate_1.0.5         codetools_0.2-20      </span></span>
<span><span class="co">## [37] ragg_1.5.0             rmarkdown_2.30         tools_4.6.0           </span></span>
<span><span class="co">## [40] htmltools_0.5.9</span></span></code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Johannes Rainer, Laurent Gatto, Philippine Louail.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.9000.</p>
</div>

      </footer>
</div>






  </body>
</html>
