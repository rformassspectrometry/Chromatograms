<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Creating new `ChromBackend` classes for Chromatograms • Chromatograms</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Creating new `ChromBackend` classes for Chromatograms">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Chromatograms</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/creating-backend-classes.html">Creating new `ChromBackend` classes for Chromatograms</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/RforMassSpectrometry/Chromatograms/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Creating new <code>ChromBackend</code> classes
for Chromatograms</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/RforMassSpectrometry/Chromatograms/blob/main/vignettes/creating-backend-classes.Rmd" class="external-link"><code>vignettes/creating-backend-classes.Rmd</code></a></small>
      <div class="hidden name"><code>creating-backend-classes.Rmd</code></div>

    </div>

    
    
<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function() {
  document.querySelector("h1").className = "title";
});
</script><script type="text/javascript">
document.addEventListener("DOMContentLoaded", function() {
  var links = document.links;  
  for (var i = 0, linksLength = links.length; i < linksLength; i++)
    if (links[i].hostname != window.location.hostname)
      links[i].target = '_blank';
});
</script><p><strong>Package</strong>: <em><a href="https://bioconductor.org/packages/3.20/Chromatograms" class="external-link">Chromatograms</a></em><br><strong>Authors</strong>: Laurent Gatto [aut] (<a href="https://orcid.org/0000-0002-1520-2268" class="external-link uri">https://orcid.org/0000-0002-1520-2268</a>), Johannes Rainer
[aut] (<a href="https://orcid.org/0000-0002-6977-7147" class="external-link uri">https://orcid.org/0000-0002-6977-7147</a>), Philippine
Louail [aut, cre] (<a href="https://orcid.org/0009-0007-5429-6846" class="external-link uri">https://orcid.org/0009-0007-5429-6846</a>)<br><strong>Compiled</strong>: Wed Jan 8 12:37:48 2025</p>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Similar to the <em><a href="https://bioconductor.org/packages/3.20/Spectra" class="external-link">Spectra</a></em>
package, the <em><a href="https://bioconductor.org/packages/3.20/Chromatograms" class="external-link">Chromatograms</a></em>
also separates the user-faced functionality to process and analyze
chromatographic mass spectrometry (MS) data from the code for storage
and <em>representation</em> of the data. The latter functionality is
provided by implementations of the <code>ChromBackend</code> class,
further on called <em>backends</em>. This vignette describes the
<code>ChromBackend</code> class and illustrates on a simple example how
a backend extending this class could be implemented.</p>
<p>Contributions to this vignette (content or correction of typos) or
requests for additional details and information are highly welcome,
ideally <em>via</em> pull requests or <em>issues</em> on the package’s
<a href="https://github.com/RforMassSpectrometry/Chromatograms" class="external-link">github
repository</a>.</p>
</div>
<div class="section level2">
<h2 id="what-is-a-chrombackend">What is a <code>ChromBackend</code>?<a class="anchor" aria-label="anchor" href="#what-is-a-chrombackend"></a>
</h2>
<p>The purpose of a backend class extending the virtual
<code>ChromBackend</code> is to provide the chromatographic MS data to
the <code>Chromatograms</code> object, which is used by the user to
interact with - and analyze the data. The <code>ChromBackend</code>
defines the API that new backends need to provide so that they can be
used with <code>Chromatograms</code>. This API defines a set of methods
to access the data. For many functions default implementations exist and
a dedicated implementation for a new backend is only needed if necessary
(e.g. if the data is stored in a way that a different access to it would
be better). In addition, a core set of variables (data fields), the so
called <em>core</em> chromatogram variables, is defined to describe the
chromatographic data. Each backend needs to provide these, but can also
define additional data fields. Before implementing a new backend it is
highly suggested to carefully read the following <em>Conventions and
definitions</em> section.</p>
<div class="section level3">
<h3 id="conventions-and-definitions">Conventions and definitions<a class="anchor" aria-label="anchor" href="#conventions-and-definitions"></a>
</h3>
<p>General conventions for chromatographic MS data of a
<code>Chromatograms</code> are:</p>
<ul>
<li>One <code>Chromatograms</code> object is designed to contain
multiple chromatographic data (not data from a single
chromatogram).</li>
<li>retention time values within each chromatogram are expected to be
sorted increasingly.</li>
<li>Missing values (<code>NA</code>) for retention time values are not
supported.</li>
<li>Properties (data fields) of a chromatogram are called
<em>chromatogram variables</em>. While backends can define their own
properties, a minimum required set of chromatogram variables
<strong>must</strong> be provided by each backend (even if their values
are empty). These <em>core chromatogram variables</em> are listed (along
with their expected data type) by the <code><a href="../reference/ChromBackend.html">coreChromVariables()</a></code>
function.</li>
<li>
<code>dataStorage</code> and <code>dataOrigin</code> are two special
variables that define for each chromatogram where the data is
(currently) stored and from where the data derived, respectively. Both
are expected to be of type<code>character</code>. Missing values for
<code>dataStorage</code> are not allowed.</li>
<li>
<code>ChromBackend</code> implementations can also represent purely
<em>read-only</em> data resources. In this case only data accessor
methods need to be implemented but not data replacement methods
(i.e. <code>&lt;-</code> methods that would allow to add or set
variables. Read-only backends should implement the
<code><a href="https://rdrr.io/pkg/ProtGenerics/man/backendInitialize.html" class="external-link">isReadOnly()</a></code> method, that should then return
<code>TRUE</code>. Note that backends for purely read-only resources
could also implement a <em>caching</em> mechanism to (temporarily) store
changes to the data locally within the object (and hence in memory). See
information on the <code>MsBackendCached</code> in the <em><a href="https://bioconductor.org/packages/3.20/Spectra" class="external-link">Spectra</a></em>
package for more details.</li>
</ul>
</div>
<div class="section level3">
<h3 id="notes-on-parallel-and-chunk-wise-processing">Notes on parallel and chunk-wise processing<a class="anchor" aria-label="anchor" href="#notes-on-parallel-and-chunk-wise-processing"></a>
</h3>
<p>For parallel processing, <code>Chromatograms</code> splits the
backend based on a defined <code>factor</code> and processes each in
parallel (or <em>in serial</em> if a <code>SerialParam</code> is used).
The splitting <code>factor</code> can be defined for
<code>Chromatograms</code> by setting the parameter
<code>processingChunkSize</code>. Alternatively, through the
<code><a href="https://rdrr.io/pkg/ProtGenerics/man/backendInitialize.html" class="external-link">backendParallelFactor()</a></code> method the backend can also
<em>suggest</em> a <code>factor</code> that should/could be used for
splitting and parallel processing. The default implementation for
<code><a href="https://rdrr.io/pkg/ProtGenerics/man/backendInitialize.html" class="external-link">backendParallelFactor()</a></code> is to return an empty
<code>factor</code> (<code><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor()</a></code>) hence not suggesting any
preferred splitting.</p>
<p>Besides parallel processing, for on-disk backends (i.e., backends
that don’t keep all of the data in memory), this chunk-wise processing
can also reduce the memory demand for operations, because only the peak
data of the current chunk needs to be realized in memory.</p>
</div>
</div>
<div class="section level2">
<h2 id="api">API<a class="anchor" aria-label="anchor" href="#api"></a>
</h2>
<p>The <code>ChromBackend</code> class defines core methods that have to
be implemented by a MS <em>backend</em> as well as <em>optional</em>
methods for which a default implementation is already available. These
functions are described in sections <em>Required methods</em> and
<em>Optional methods</em>, respectively.</p>
<p>To create a new backend a class extending the virtual
<code>ChromBackend</code> needs to be implemented. In the following
example we define a simple class that uses a <code>data.frame</code> to
store general properties (<em>chromatogram variables</em>) and a list of
<code>data.frame</code> for the retention time and intensity values of
each chromatograms, which represent the actual chromatographic MS data.
These values are store in a <code>list</code>, where each element
correspond to one chromatogram, as the number of values (<em>peaks</em>)
can vary between chromatograms. We also provide a basic constructor
function that returns an empty instance of the new class.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RforMassSpectrometry/Chromatograms" class="external-link">Chromatograms</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">#' Definition of the backend class extending ChromBackend</span></span>
<span><span class="kw">setClass</span><span class="op">(</span><span class="st">"ChromBackendTest"</span>,</span>
<span>         contains <span class="op">=</span> <span class="st">"ChromBackend"</span>,</span>
<span>         slots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>             chromData <span class="op">=</span> <span class="st">"data.frame"</span>,</span>
<span>             peaksData <span class="op">=</span> <span class="st">"list"</span></span>
<span>         <span class="op">)</span>,</span>
<span>         prototype <span class="op">=</span> <span class="fu">prototype</span><span class="op">(</span></span>
<span>             chromData <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>             peaksData <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>         <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#' Simple constructor function</span></span>
<span><span class="va">ChromBackendTest</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">new</span><span class="op">(</span><span class="st">"ChromBackendTest"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>The 2 slots <code>@chromData</code> and <code>@peaksData</code> will
be used to store the general properties of the chromatograms and the
actual chromatographic data, respectively. each row in
<code>chromData</code> will contain data for one chromatogram with the
columns being the different <em>chromatogram variables</em>
(i.e. additional properties of a chromatogram such as its m/z value or
MS level) and each element in <code>@peaksData</code> a
<code>data.frame</code> with the retention time and intensity values
representing thus the <em>peaks</em> data of the respective
chromatogram. This is only one of the possibly many ways chromatographic
data might be represented.</p>
<p>We should ideally also add some basic validity function that ensures
the data to be correct (valid). The function below simply checks that
the number of rows of the <code>@chromData</code> slot matches the
length of the <code>@peaksData</code> slots.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Basic validation function</span></span>
<span><span class="fu">setValidity</span><span class="op">(</span><span class="st">"ChromBackendTest"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">object</span><span class="op">@</span><span class="va">peaksData</span><span class="op">)</span> <span class="op">!=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">object</span><span class="op">@</span><span class="va">chromData</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="st">"length of 'peaksData' has to match the number of rows of "</span>,</span>
<span>               <span class="st">"'chromData'"</span><span class="op">)</span></span>
<span>    <span class="cn">NULL</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Class "ChromBackendTest" [in ".GlobalEnv"]</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Slots:</span></span>
<span><span class="co">##                                        </span></span>
<span><span class="co">## Name:   chromData  peaksData    version</span></span>
<span><span class="co">## Class: data.frame       list  character</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Extends: "ChromBackend"</span></span></code></pre>
<p>We can now create an instance of our new class with the
<code>ChromBackendTest()</code> function.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Create an empty instance of ChromBackendTest</span></span>
<span><span class="va">be</span> <span class="op">&lt;-</span> <span class="fu">ChromBackendTest</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">be</span></span></code></pre></div>
<pre><code><span><span class="co">## An object of class "ChromBackendTest"</span></span>
<span><span class="co">## Slot "chromData":</span></span>
<span><span class="co">## data frame with 0 columns and 0 rows</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Slot "peaksData":</span></span>
<span><span class="co">## list()</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Slot "version":</span></span>
<span><span class="co">## [1] "0.1"</span></span></code></pre>
<p>A <code>show()</code> method would allow for a more convenient way
how general information of our object is displayed. Below we add an
implementation of the <code>show()</code> method.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' implementation of show for ChromBackendTest</span></span>
<span><span class="kw">setMethod</span><span class="op">(</span><span class="st">"show"</span>, <span class="st">"ChromBackendTest"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">cd</span> <span class="op">&lt;-</span> <span class="va">object</span><span class="op">@</span><span class="va">chromData</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span>, <span class="st">"with"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">cd</span><span class="op">)</span>, <span class="st">"chromatograms\n"</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">be</span></span></code></pre></div>
<pre><code><span><span class="co">## ChromBackendTest with 0 chromatograms</span></span></code></pre>
<div class="section level3">
<h3 id="required-methods">Required methods<a class="anchor" aria-label="anchor" href="#required-methods"></a>
</h3>
<p>Methods listed in this section <strong>must</strong> be implemented
for a new class extending <code>ChromBackend</code>. Methods should
ideally also be implemented in the order they are listed here. Also, it
is strongly advised to write dedicated unit tests for each newly
implemented method or function already <strong>during</strong> the
development.</p>
<div class="section level4">
<h4 id="datastorage">
<code>dataStorage()</code><a class="anchor" aria-label="anchor" href="#datastorage"></a>
</h4>
<p>The <code>dataStorage</code> chromatogram variable provides
information how or where the data is stored. The
<code><a href="../reference/chromData.html">dataStorage()</a></code> method should therefore return a
<code>character</code> vector of length equal to the number of
chromatograms that are represented by the object. The values for
<code>dataStorage</code> can be any character value, except
<code>NA</code>. For our example backend we define a simple
<code><a href="../reference/chromData.html">dataStorage()</a></code> method that simply returns the column
<code>"dataStorage"</code> from the <code>@chromData</code> (as a
<code>character</code>).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' dataStorage method to provide information *where* data is stored</span></span>
<span><span class="kw">setMethod</span><span class="op">(</span><span class="st">"dataStorage"</span>, <span class="st">"ChromBackendTest"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">object</span><span class="op">@</span><span class="va">chromData</span><span class="op">$</span><span class="va">dataStorage</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>Calling <code><a href="../reference/chromData.html">dataStorage()</a></code> on our example backend will thus
return an empty <code>character</code> (since the object created above
does not contain any data).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/chromData.html">dataStorage</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## character(0)</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="length">
<code>length()</code><a class="anchor" aria-label="anchor" href="#length"></a>
</h4>
<p><code><a href="https://rdrr.io/r/base/length.html" class="external-link">length()</a></code> is expected to return an <code>integer</code>
of length 1 with the total number of chromatograms that are represented
by the backend. For our example backend we simply return the number of
rows of the <code>data.frame</code> stored in the
<code>@chromData</code> slot.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' length to provide information on the number of chromatograms</span></span>
<span><span class="kw">setMethod</span><span class="op">(</span><span class="st">"length"</span>, <span class="st">"ChromBackendTest"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">@</span><span class="va">chromData</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="backendinitialize">
<code>backendInitialize()</code><a class="anchor" aria-label="anchor" href="#backendinitialize"></a>
</h4>
<p>The <code><a href="https://rdrr.io/pkg/ProtGenerics/man/backendInitialize.html" class="external-link">backendInitialize()</a></code> method should be called after
creating an instance of the backend class and is responsible for
preparing (initializing) the backend with data. This method can accept
any parameters required by the backend to load or initialize the data,
such as file names, a database connection, or objects containing the
data. It is also recommended that the the special chromatogram variables
<code>dataStorage</code> and <code>dataOrigin</code> are set during
<code><a href="https://rdrr.io/pkg/ProtGenerics/man/backendInitialize.html" class="external-link">backendInitialize()</a></code>.</p>
<p>It is strongly recommended to validate the input data within the
initialize method. The advantage of performing these validity checks in
<code><a href="https://rdrr.io/pkg/ProtGenerics/man/backendInitialize.html" class="external-link">backendInitialize()</a></code> rather than using
<code>setValidity()</code> is that computationally expensive
operations/checks would only be performed once,during initialization,
instead of each time values within the object are modified (e.g.,
through subsetting or similar operations), which would occur with
<code>setValidity()</code>.</p>
<p>We also use the <code><a href="../reference/hidden_aliases.html">validChromData()</a></code> and
<code><a href="../reference/hidden_aliases.html">validPeaksData()</a></code> functions to ensure that core chromatogram
variables and core peaks variables have the correct data type. These
checks verify that the<code>peaksData</code> contains only numeric
values and that the number of retention time and intensity values
matches for each chromatogram.</p>
<p>Below we define a <code><a href="https://rdrr.io/pkg/ProtGenerics/man/backendInitialize.html" class="external-link">backendInitialize()</a></code> method that
accepts a <code>data.frame</code> containing chromatogram variables and
a <code>list</code> with retention time and intensity values for each
chromatogram.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' backendInitialize method to fill the backend with data.</span></span>
<span><span class="kw">setMethod</span><span class="op">(</span></span>
<span>    <span class="st">"backendInitialize"</span>, <span class="st">"ChromBackendTest"</span>,</span>
<span>    <span class="kw">function</span><span class="op">(</span><span class="va">object</span>, <span class="va">chromData</span>, <span class="va">peaksData</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">is.data.frame</a></span><span class="op">(</span><span class="va">chromData</span><span class="op">)</span><span class="op">)</span></span>
<span>            <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"'chromData' needs to be a 'data.frame' with the general"</span>,</span>
<span>                 <span class="st">"chromatogram variables"</span><span class="op">)</span></span>
<span>        <span class="co">## Defining dataStorage and dataOrigin, if not available</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">chromData</span><span class="op">$</span><span class="va">dataStorage</span><span class="op">)</span><span class="op">)</span></span>
<span>            <span class="va">chromData</span><span class="op">$</span><span class="va">dataStorage</span> <span class="op">&lt;-</span> <span class="st">"&lt;memory&gt;"</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">chromData</span><span class="op">$</span><span class="va">dataOrigin</span><span class="op">)</span><span class="op">)</span></span>
<span>            <span class="va">chromData</span><span class="op">$</span><span class="va">dataOrigin</span> <span class="op">&lt;-</span> <span class="st">"&lt;user provided&gt;"</span></span>
<span>        <span class="co">## Validate the provided data</span></span>
<span>        <span class="fu"><a href="../reference/hidden_aliases.html">validChromData</a></span><span class="op">(</span><span class="va">chromData</span><span class="op">)</span></span>
<span>        <span class="fu"><a href="../reference/hidden_aliases.html">validPeaksData</a></span><span class="op">(</span><span class="va">peaksData</span><span class="op">)</span></span>
<span>        <span class="co">## Fill the object with data</span></span>
<span>        <span class="va">object</span><span class="op">@</span><span class="va">chromData</span> <span class="op">&lt;-</span> <span class="va">chromData</span></span>
<span>        <span class="va">object</span><span class="op">@</span><span class="va">peaksData</span> <span class="op">&lt;-</span> <span class="va">peaksData</span></span>
<span>        <span class="va">object</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>In addition to adding the data to object, the function also defined
the <code>dataStorage</code> and <code>dataOrigin</code> spectra
variables. The purpose of these two variables is to provide some
information on where the data is currently stored (<em>in memory</em> as
in our example) and from where the data is originating.</p>
<p>We can now create an instance of our backend class and fill it with
data. We thus first define our MS data and pass this to the
<code><a href="https://rdrr.io/pkg/ProtGenerics/man/backendInitialize.html" class="external-link">backendInitialize()</a></code> method.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># A data.frame with chromatogram variables.</span></span>
<span><span class="va">cdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>msLevel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">1L</span><span class="op">)</span>,</span>
<span>                    mz <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">112.2</span>, <span class="fl">123.3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Retention time and intensity values for each chromatogram.</span></span>
<span><span class="va">pdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>rtime <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12.4</span>, <span class="fl">12.8</span>, <span class="fl">13.2</span>, <span class="fl">14.6</span><span class="op">)</span>,</span>
<span>       intensity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">123.3</span>, <span class="fl">153.6</span>, <span class="fl">2354.3</span>, <span class="fl">243.4</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>rtime <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">45.1</span>, <span class="fl">46.2</span><span class="op">)</span>,</span>
<span>       intensity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">80.1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#' Create and initialize the backend</span></span>
<span><span class="va">be</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/backendInitialize.html" class="external-link">backendInitialize</a></span><span class="op">(</span><span class="fu">ChromBackendTest</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                        chromData <span class="op">=</span> <span class="va">cdata</span>, peaksData <span class="op">=</span> <span class="va">pdata</span><span class="op">)</span></span>
<span><span class="va">be</span></span></code></pre></div>
<pre><code><span><span class="co">## ChromBackendTest with 2 chromatograms</span></span></code></pre>
<p>This <code><a href="https://rdrr.io/pkg/ProtGenerics/man/backendInitialize.html" class="external-link">backendInitialize()</a></code> implementation should assure
data validity and integrity. Below we use this function again to create
our backend instance.</p>
<p>The <code><a href="https://rdrr.io/pkg/ProtGenerics/man/backendInitialize.html" class="external-link">backendInitialize()</a></code> method that we implemented for
our backend class expects the user to provide the full MS data. It would
alternatively also be possible to implement a method that takes data
file names as input from which the function can then import the data.
The purpose of the <code><a href="https://rdrr.io/pkg/ProtGenerics/man/backendInitialize.html" class="external-link">backendInitialize()</a></code> method is to
<em>initialize</em> and prepare the data in a way that it can be
accessed by a <code>Chromatograms</code> object. Whether the data is
actually loaded into memory or simply referenced and loaded upon request
does not matter as long as the backend is able to provide the data
though its accessor methods when requested by the
<code>Chromatograms</code> object.</p>
</div>
<div class="section level4">
<h4 id="chromvariables">
<code>chromVariables()</code><a class="anchor" aria-label="anchor" href="#chromvariables"></a>
</h4>
<p>The <code><a href="../reference/chromData.html">chromVariables()</a></code> method should return a
<code>character</code> vector with the names of all available
chromatogram variables of the backend. While a backend class should
support defining and providing their own variables, each
<code>ChromBackend</code> class <strong>must</strong> provide also the
<em>core chromatogram variables</em> (in the correct data type). These
can be listed by the <code><a href="../reference/ChromBackend.html">coreChromVariables()</a></code> function:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' List core chromatogram variables along with data types.</span></span>
<span><span class="fu"><a href="../reference/ChromBackend.html">coreChromVariables</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      chromIndex collisionEnergy      dataOrigin     dataStorage         msLevel </span></span>
<span><span class="co">##       "integer"       "numeric"     "character"     "character"       "integer" </span></span>
<span><span class="co">##              mz           mzMin           mzMax     precursorMz  precursorMzMin </span></span>
<span><span class="co">##       "numeric"       "numeric"       "numeric"       "numeric"       "numeric" </span></span>
<span><span class="co">##  precursorMzMax       productMz    productMzMin    productMzMax </span></span>
<span><span class="co">##       "numeric"       "numeric"       "numeric"       "numeric"</span></span></code></pre>
<p>A typical <code><a href="../reference/chromData.html">chromVariables()</a></code> method for a
<code>ChromBackend</code> class will thus be implemented similarly to
the one for our <code>ChromBackendTest</code> test backend: it will
return the names for all available chromatogram variables that can be
called by <code><a href="../reference/chromData.html">chromData()</a></code> within the backend object. There is a
default implementation for <code><a href="../reference/chromData.html">chromVariables()</a></code> that will
return the core chromatogram variables. However if a backend class
defines additional chromatogram variables, the
<code><a href="../reference/chromData.html">chromVariables()</a></code> method should be implemented to return the
names of these additional variables as well.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Accessor for available chromatogram variables</span></span>
<span><span class="kw">setMethod</span><span class="op">(</span><span class="st">"chromVariables"</span>, <span class="st">"ChromBackendTest"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">union</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">object</span><span class="op">@</span><span class="va">chromData</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="../reference/ChromBackend.html">coreChromVariables</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/chromData.html">chromVariables</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "msLevel"         "mz"              "dataStorage"     "dataOrigin"     </span></span>
<span><span class="co">##  [5] "chromIndex"      "collisionEnergy" "mzMin"           "mzMax"          </span></span>
<span><span class="co">##  [9] "precursorMz"     "precursorMzMin"  "precursorMzMax"  "productMz"      </span></span>
<span><span class="co">## [13] "productMzMin"    "productMzMax"</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="chromdata">
<code>chromData()</code><a class="anchor" aria-label="anchor" href="#chromdata"></a>
</h4>
<p>The <code>chromData</code> method should return the
<strong>full</strong> chromatogram data within a backend as a
<code>data.frame</code> object. A parameter <code>columns</code> should
allow to define the names of the variables that should be returned. A
parameter <code>drop</code> should also be implemented to allow for the
calling of one column while still controlling the return type. Each row
in this data frame should represent one chromatogram, each column a
chromatogram variable. The <code>data.frame</code> <strong>must</strong>
provide values (even if they are <code>NA</code>) for
<strong>all</strong> requested chromatogram variables of the backend
(<strong>including</strong> the core chromatogram variables). The
<code><a href="../reference/hidden_aliases.html">fillCoreChromVariables()</a></code> function from the
<em>Chromatograms</em> package allows to <em>complete</em> (fill) a
provided <code>data.frame</code> with eventually missing core
chromatogram variables:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Get the data.frame with the available chrom variables</span></span>
<span><span class="va">be</span><span class="op">@</span><span class="va">chromData</span></span></code></pre></div>
<pre><code><span><span class="co">##   msLevel    mz dataStorage      dataOrigin</span></span>
<span><span class="co">## 1       1 112.2    &lt;memory&gt; &lt;user provided&gt;</span></span>
<span><span class="co">## 2       1 123.3    &lt;memory&gt; &lt;user provided&gt;</span></span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Complete this data.frame with missing core variables</span></span>
<span><span class="fu"><a href="../reference/hidden_aliases.html">fillCoreChromVariables</a></span><span class="op">(</span><span class="va">be</span><span class="op">@</span><span class="va">chromData</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   msLevel    mz dataStorage      dataOrigin chromIndex collisionEnergy mzMin</span></span>
<span><span class="co">## 1       1 112.2    &lt;memory&gt; &lt;user provided&gt;         NA              NA    NA</span></span>
<span><span class="co">## 2       1 123.3    &lt;memory&gt; &lt;user provided&gt;         NA              NA    NA</span></span>
<span><span class="co">##   mzMax precursorMz precursorMzMin precursorMzMax productMz productMzMin</span></span>
<span><span class="co">## 1    NA          NA             NA             NA        NA           NA</span></span>
<span><span class="co">## 2    NA          NA             NA             NA        NA           NA</span></span>
<span><span class="co">##   productMzMax</span></span>
<span><span class="co">## 1           NA</span></span>
<span><span class="co">## 2           NA</span></span></code></pre>
<p>We can thus use this function to add eventually missing core
chromatogram variables in the <code>chromData</code> implementation for
our backend:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' function to extract the full chromData</span></span>
<span><span class="kw">setMethod</span><span class="op">(</span></span>
<span>    <span class="st">"chromData"</span>, <span class="st">"ChromBackendTest"</span>,</span>
<span>    <span class="kw">function</span><span class="op">(</span><span class="va">object</span>, <span class="va">columns</span> <span class="op">=</span> <span class="fu"><a href="../reference/chromData.html">chromVariables</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span>,</span>
<span>             <span class="va">drop</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="fu"><a href="../reference/chromData.html">chromVariables</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">columns</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Some of the requested Chromatogram variables are not "</span>,</span>
<span>                   <span class="st">"available"</span><span class="op">)</span></span>
<span>      <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hidden_aliases.html">fillCoreChromVariables</a></span><span class="op">(</span><span class="va">object</span><span class="op">@</span><span class="va">chromData</span><span class="op">)</span></span>
<span>      <span class="va">res</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">[</span>, <span class="va">columns</span>, drop <span class="op">=</span> <span class="va">drop</span><span class="op">]</span></span>
<span>      <span class="va">res</span></span>
<span>      <span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>We can now use <code><a href="../reference/chromData.html">chromData()</a></code> to either extract the full
chromatogram data from the backend, or only the data for selected
variables.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Extract the full data</span></span>
<span><span class="fu"><a href="../reference/chromData.html">chromData</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   msLevel    mz dataStorage      dataOrigin chromIndex collisionEnergy mzMin</span></span>
<span><span class="co">## 1       1 112.2    &lt;memory&gt; &lt;user provided&gt;         NA              NA    NA</span></span>
<span><span class="co">## 2       1 123.3    &lt;memory&gt; &lt;user provided&gt;         NA              NA    NA</span></span>
<span><span class="co">##   mzMax precursorMz precursorMzMin precursorMzMax productMz productMzMin</span></span>
<span><span class="co">## 1    NA          NA             NA             NA        NA           NA</span></span>
<span><span class="co">## 2    NA          NA             NA             NA        NA           NA</span></span>
<span><span class="co">##   productMzMax</span></span>
<span><span class="co">## 1           NA</span></span>
<span><span class="co">## 2           NA</span></span></code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Selected variables</span></span>
<span><span class="fu"><a href="../reference/chromData.html">chromData</a></span><span class="op">(</span><span class="va">be</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mz"</span>, <span class="st">"msLevel"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      mz msLevel</span></span>
<span><span class="co">## 1 112.2       1</span></span>
<span><span class="co">## 2 123.3       1</span></span></code></pre>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Only missing core spectra variables</span></span>
<span><span class="fu"><a href="../reference/chromData.html">chromData</a></span><span class="op">(</span><span class="va">be</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"collisionEnergy"</span>, <span class="st">"mzMin"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   collisionEnergy mzMin</span></span>
<span><span class="co">## 1              NA    NA</span></span>
<span><span class="co">## 2              NA    NA</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="peaksvariables">
<code>peaksVariables()</code><a class="anchor" aria-label="anchor" href="#peaksvariables"></a>
</h4>
<p>The <code><a href="https://rdrr.io/pkg/ProtGenerics/man/peaksData.html" class="external-link">peaksVariables()</a></code> function is supposed to provide the
names of the available <em>peaks variables</em>. If additional peaks
variables would be available, these could also be listed by the
<code><a href="https://rdrr.io/pkg/ProtGenerics/man/peaksData.html" class="external-link">peaksVariables()</a></code> method. There is a default implementation
for <code>peaksVaraibles()</code> that will return the core peaks
variables. However if a backend class defines additional peaks
variables, the <code><a href="https://rdrr.io/pkg/ProtGenerics/man/peaksData.html" class="external-link">peaksVariables()</a></code> method should be
implemented to return the names of these additional variables as
well.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">setMethod</span><span class="op">(</span><span class="st">"peaksVariables"</span>, <span class="st">"ChromBackendTest"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">union</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="../reference/ChromBackend.html">corePeaksVariables</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">object</span><span class="op">@</span><span class="va">peaksData</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>We can now see what peaks variables are present in our object:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/peaksData.html" class="external-link">peaksVariables</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "rtime"     "intensity"</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="peaksdata">
<code>peaksData()</code><a class="anchor" aria-label="anchor" href="#peaksdata"></a>
</h4>
<p>The <code><a href="https://rdrr.io/pkg/ProtGenerics/man/peaksData.html" class="external-link">peaksData()</a></code> method extracts the chromatographic data
(<em>peaks</em>), i.e., the chromatograms’ retention time and intensity
values. This data is returned as a <code>list</code> of
<code>data.frame</code>, with one array per chromatogram with columns
being the <em>peaks variables</em> (retention time and intensity values)
and rows the individual data pairs. Each backend must provide retention
times and intensity values with this method, but additional peaks
variables (columns) are also supported.</p>
<p>In a similar way as for the chromatogram variables, a backend should
support defining and providing their own variables and each
<code>ChromBackend</code> class <strong>must</strong> provide also the
<em>core peaks variables</em> (in the correct data type). These can be
listed by the <code><a href="../reference/ChromBackend.html">corePeaksVariables()</a></code> function:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ChromBackend.html">corePeaksVariables</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     rtime intensity </span></span>
<span><span class="co">## "numeric" "numeric"</span></span></code></pre>
<p>Below we implement the <code><a href="https://rdrr.io/pkg/ProtGenerics/man/peaksData.html" class="external-link">peaksData()</a></code> method for our
backend.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' method to extract the full chromatographic data as list of arrays</span></span>
<span><span class="kw">setMethod</span><span class="op">(</span></span>
<span>    <span class="st">"peaksData"</span>, <span class="st">"ChromBackendTest"</span>,</span>
<span>    <span class="kw">function</span><span class="op">(</span><span class="va">object</span>, <span class="va">columns</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/peaksData.html" class="external-link">peaksVariables</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span>, <span class="va">drop</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> </span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="va">columns</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/peaksData.html" class="external-link">peaksVariables</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Some of the requested peaks variables are not available"</span><span class="op">)</span></span>
<span>      <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">object</span><span class="op">@</span><span class="va">peaksData</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span>, <span class="va">columns</span>, drop <span class="op">=</span> <span class="va">drop</span><span class="op">]</span><span class="op">)</span></span>
<span>      <span class="va">res</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>And with this method we can now extract the peaks data from our
backend.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Extract the *peaks* data (i.e. intensity and retention times)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/peaksData.html" class="external-link">peaksData</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [[1]]</span></span>
<span><span class="co">##   rtime intensity</span></span>
<span><span class="co">## 1  12.4     123.3</span></span>
<span><span class="co">## 2  12.8     153.6</span></span>
<span><span class="co">## 3  13.2    2354.3</span></span>
<span><span class="co">## 4  14.6     243.4</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[2]]</span></span>
<span><span class="co">##   rtime intensity</span></span>
<span><span class="co">## 1  45.1     100.0</span></span>
<span><span class="co">## 2  46.2      80.1</span></span></code></pre>
<p>Since the <code><a href="https://rdrr.io/pkg/ProtGenerics/man/peaksData.html" class="external-link">peaksData()</a></code> method is the main function used
by a <code>Chromatograms</code> to retrieve data from the backend (and
further process the values), this method should be implemented in an
efficient way.</p>
</div>
<div class="section level4">
<h4 id="section">
<code>[</code><a class="anchor" aria-label="anchor" href="#section"></a>
</h4>
<p>The <code>[</code> method allows to subset <code>ChromBackend</code>
objects. This operation is expected to reduce a
<code>ChromBackend</code> object to the selected chromatograms without
changing values for the subset chromatograms. The method should support
to subset by indices or logical vectors and should also support
duplicating elements (i.e., when duplicated indices are used) as well as
to subset in arbitrary order. An error should be thrown if indices are
out of bounds, but the method should also support returning an empty
backend with <code>[integer()]</code>. The
<code><a href="https://rdrr.io/pkg/MsCoreUtils/man/i2index.html" class="external-link">MsCoreUtils::i2index</a></code> function can be used to check and
convert the provided parameter <code>i</code> (defining the subset) to
an integer vector.</p>
<p>Below we implement a possible <code>[</code> for our test backend
class. We ignore the parameters <code>j</code> from the definition of
the <code>[</code> generic, since we treat our data to be
one-dimensional (with each chromatogram being one element).</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Main subset method.</span></span>
<span><span class="kw">setMethod</span><span class="op">(</span><span class="st">"["</span>, <span class="st">"ChromBackendTest"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">i</span>, <span class="va">j</span>, <span class="va">...</span>, <span class="va">drop</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">i</span> <span class="op">&lt;-</span> <span class="fu">MsCoreUtils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MsCoreUtils/man/i2index.html" class="external-link">i2index</a></span><span class="op">(</span><span class="va">i</span>, length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">x</span><span class="op">@</span><span class="va">chromData</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">@</span><span class="va">chromData</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span></span>
<span>  <span class="va">x</span><span class="op">@</span><span class="va">peaksData</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">@</span><span class="va">peaksData</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="va">x</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>We can now subset our backend to the last two chromatograms.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="va">be</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="fu"><a href="../reference/chromData.html">chromData</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   msLevel    mz dataStorage      dataOrigin chromIndex collisionEnergy mzMin</span></span>
<span><span class="co">## 1       1 112.2    &lt;memory&gt; &lt;user provided&gt;         NA              NA    NA</span></span>
<span><span class="co">##   mzMax precursorMz precursorMzMin precursorMzMax productMz productMzMin</span></span>
<span><span class="co">## 1    NA          NA             NA             NA        NA           NA</span></span>
<span><span class="co">##   productMzMax</span></span>
<span><span class="co">## 1           NA</span></span></code></pre>
<p>Or extracting the second chromatogram multiple times.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="va">be</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="../reference/chromData.html">chromData</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     msLevel    mz dataStorage      dataOrigin chromIndex collisionEnergy mzMin</span></span>
<span><span class="co">## 1         1 112.2    &lt;memory&gt; &lt;user provided&gt;         NA              NA    NA</span></span>
<span><span class="co">## 1.1       1 112.2    &lt;memory&gt; &lt;user provided&gt;         NA              NA    NA</span></span>
<span><span class="co">## 1.2       1 112.2    &lt;memory&gt; &lt;user provided&gt;         NA              NA    NA</span></span>
<span><span class="co">##     mzMax precursorMz precursorMzMin precursorMzMax productMz productMzMin</span></span>
<span><span class="co">## 1      NA          NA             NA             NA        NA           NA</span></span>
<span><span class="co">## 1.1    NA          NA             NA             NA        NA           NA</span></span>
<span><span class="co">## 1.2    NA          NA             NA             NA        NA           NA</span></span>
<span><span class="co">##     productMzMax</span></span>
<span><span class="co">## 1             NA</span></span>
<span><span class="co">## 1.1           NA</span></span>
<span><span class="co">## 1.2           NA</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="section-1">
<code>$</code><a class="anchor" aria-label="anchor" href="#section-1"></a>
</h4>
<p>The <code>$</code> method is expected to extract a single
chromatogram or peaks variable from a backend. Parameter
<code>name</code> should allow to name the variable to return. Each
<code>ChromBackend</code> <strong>must</strong> support extracting the
core chromatogram and core peaks variables with this method (even if no
data might be available for that variable). In our example
implementation below we make use of the <code><a href="../reference/chromData.html">chromData()</a></code> method,
but more efficient implementations might be possible as well. Also, the
<code>$</code> method should check if the requested variable is
available and should throw an error otherwise.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Access a single chromatogram variable</span></span>
<span><span class="kw">setMethod</span><span class="op">(</span><span class="st">"$"</span>, <span class="st">"ChromBackendTest"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">name</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">union</a></span><span class="op">(</span><span class="fu"><a href="../reference/chromData.html">chromVariables</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="../reference/ChromBackend.html">coreChromVariables</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/chromData.html">chromData</a></span><span class="op">(</span><span class="va">x</span>, columns <span class="op">=</span> <span class="va">name</span>, drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/peaksData.html" class="external-link">peaksVariables</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/peaksData.html" class="external-link">peaksData</a></span><span class="op">(</span><span class="va">x</span>, columns <span class="op">=</span> <span class="va">name</span>, drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="kw">else</span> <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"The requested variable '"</span>, <span class="va">name</span>, <span class="st">"' is not available"</span><span class="op">)</span></span>
<span>  <span class="va">res</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>With this we can now extract the MS levels</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">be</span><span class="op">$</span><span class="va">msLevel</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1 1</span></span></code></pre>
<p>or a core chromatogram variable without values in our example
backend.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">be</span><span class="op">$</span><span class="va">precursorMz</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] NA NA</span></span></code></pre>
<p>or also the intensity values</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">be</span><span class="op">$</span><span class="va">intensity</span></span></code></pre></div>
<pre><code><span><span class="co">## [[1]]</span></span>
<span><span class="co">## [1]  123.3  153.6 2354.3  243.4</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[2]]</span></span>
<span><span class="co">## [1] 100.0  80.1</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="backendmerge">
<code>backendMerge()</code><a class="anchor" aria-label="anchor" href="#backendmerge"></a>
</h4>
<p>The <code><a href="https://rdrr.io/pkg/ProtGenerics/man/backendInitialize.html" class="external-link">backendMerge()</a></code> method merges (combines)
<code>ChromBackend</code> objects (of the same type!) into a single
instance. For our test backend we thus need to combine the values in the
<code>@chromData</code>, <code>@peaksData</code> slots. To support also
merging of <code>data.frame</code>s with different sets of columns we
use the <code><a href="https://rdrr.io/pkg/MsCoreUtils/man/rbindFill.html" class="external-link">MsCoreUtils::rbindFill</a></code> function instead of a simple
<code>rbind</code> (this function joins data frames making an union of
all available columns filling eventually missing columns with
<code>NA</code>).</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Method allowing to join (concatenate) backends</span></span>
<span><span class="kw">setMethod</span><span class="op">(</span><span class="st">"backendMerge"</span>, <span class="st">"ChromBackendTest"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">res</span> <span class="op">&lt;-</span> <span class="va">object</span></span>
<span>    <span class="va">object</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">res</span><span class="op">@</span><span class="va">peaksData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">c</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">object</span>, <span class="kw">function</span><span class="op">(</span><span class="va">z</span><span class="op">)</span> <span class="va">z</span><span class="op">@</span><span class="va">peaksData</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">res</span><span class="op">@</span><span class="va">chromData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="fu">MsCoreUtils</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MsCoreUtils/man/rbindFill.html" class="external-link">rbindFill</a></span>,</span>
<span>                             <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">object</span>, <span class="kw">function</span><span class="op">(</span><span class="va">z</span><span class="op">)</span> <span class="va">z</span><span class="op">@</span><span class="va">chromData</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu">validObject</span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span>    <span class="va">res</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>Testing the function by merging the example backend instance with
itself.</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/backendInitialize.html" class="external-link">backendMerge</a></span><span class="op">(</span><span class="va">be</span>, <span class="va">be</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">be</span><span class="op">)</span></span>
<span><span class="va">a</span></span></code></pre></div>
<pre><code><span><span class="co">## ChromBackendTest with 5 chromatograms</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="data-replacement-methods">Data replacement methods<a class="anchor" aria-label="anchor" href="#data-replacement-methods"></a>
</h3>
<p>As stated in the general description, <code>ChromBackend</code>
implementations can also be purely <em>read-only</em> resources allowing
to just access, but not to replace data. For these backends
<code><a href="https://rdrr.io/pkg/ProtGenerics/man/backendInitialize.html" class="external-link">isReadOnly()</a></code> should return <code>FALSE</code>. Data
replacement methods listed in this section would not need to be
implemented. Our example backend stores the full data in memory, within
the object, and hence we can easily change and replace values.</p>
<p>Since we support replacing values we also implement the
<code><a href="https://rdrr.io/pkg/ProtGenerics/man/backendInitialize.html" class="external-link">isReadOnly()</a></code> method for our example implementation to
return <code>FALSE</code> (instead of the default
<code>TRUE</code>).</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Default for backends:</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/backendInitialize.html" class="external-link">isReadOnly</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] FALSE</span></span></code></pre>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Implementation of isReadOnly for ChromBackendTest</span></span>
<span><span class="kw">setMethod</span><span class="op">(</span><span class="st">"isReadOnly"</span>, <span class="st">"ChromBackendTest"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/backendInitialize.html" class="external-link">isReadOnly</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] FALSE</span></span></code></pre>
<p>All data replacement function are expected to return an instance of
the same backend class that was used as input.</p>
<div class="section level4">
<h4 id="chromdata-">
<code>chromData&lt;-</code><a class="anchor" aria-label="anchor" href="#chromdata-"></a>
</h4>
<p>The main replacement method is <code>chromData&lt;-</code> which
should allow to replace the chormtaogram variables content of a backend
with new data. This data is expected to be provided as a
<code>data.frame</code> (similar to the one returned by
<code><a href="../reference/chromData.html">chromData()</a></code>). While values can be replaced, the number of
chromatograms before and after a call to <code>chromData&lt;-</code> has
to be the same.</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Replacement method for the full chromatogram data</span></span>
<span><span class="fu">setReplaceMethod</span><span class="op">(</span><span class="st">"chromData"</span>, <span class="st">"ChromBackendTest"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">object</span>, <span class="va">value</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu">is</span><span class="op">(</span><span class="va">value</span>, <span class="st">"DataFrame"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">value</span> <span class="op">&lt;-</span> <span class="fu">as</span><span class="op">(</span><span class="va">value</span>, <span class="st">"data.frame"</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">inherits</a></span><span class="op">(</span><span class="va">value</span>, <span class="st">"data.frame"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"'value' is expected to be a 'data.frame'"</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">!=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"'value' has to be a 'data.frame' with "</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span>, <span class="st">" rows"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/hidden_aliases.html">validChromData</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span></span>
<span>  <span class="va">object</span><span class="op">@</span><span class="va">chromData</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span>  <span class="va">object</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>To test this new method we extract the full chromatogram data from
our example data set, add an additional column (chromatogram variable)
and use <code>chromData&lt;-</code> to replace the data of the
backend.</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/chromData.html">chromData</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span></span>
<span><span class="va">d</span><span class="op">$</span><span class="va">new_col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/chromData.html">chromData</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">d</span></span></code></pre></div>
<p>Check that we have now also the new column available.</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">be</span><span class="op">$</span><span class="va">new_col</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "a" "b"</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="section-2">
<code>$&lt;-</code><a class="anchor" aria-label="anchor" href="#section-2"></a>
</h4>
<p>The <code>$&lt;-</code> method should allow to replace values for an
existing chromatogram variable or to add an additional variable to the
backend. As with all replacement methods, the <code>length</code> of
<code>value</code> has to match the number of chromatograms represented
by the backend. For replacement of retention time or intensity values we
need also to ensure that the data would be correct after the operation,
i.e., that the number of retention time and intensity values per
chromatogram are the identical and that all retention time and intensity
values are numeric. Finally, we use the <code><a href="../reference/hidden_aliases.html">validChromData()</a></code>
function to ensure that, after replacement, all core chromatogram
variables have the correct data type.</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Replace or add a single chromatogram variable.</span></span>
<span><span class="fu">setReplaceMethod</span><span class="op">(</span><span class="st">"$"</span>, <span class="st">"ChromBackendTest"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">name</span>, <span class="va">value</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span> <span class="op">!=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"length of 'value' needs to match the number of chromatograms "</span>,</span>
<span>         <span class="st">"in object."</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/peaksData.html" class="external-link">peaksVariables</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">is.list</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"The value for peaksData should be a list"</span><span class="op">)</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">x</span><span class="op">@</span><span class="va">peaksData</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="va">name</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">value</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span>
<span>      <span class="fu"><a href="../reference/hidden_aliases.html">validPeaksData</a></span><span class="op">(</span><span class="va">x</span><span class="op">@</span><span class="va">peaksData</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">x</span><span class="op">@</span><span class="va">chromData</span><span class="op">[</span>, <span class="va">name</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span>    <span class="fu"><a href="../reference/hidden_aliases.html">validChromData</a></span><span class="op">(</span><span class="va">x</span><span class="op">@</span><span class="va">chromData</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">x</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>We can thus replace an existing chromatogram variable, such as
<code>msLevel</code>:</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Values before replacement</span></span>
<span><span class="va">be</span><span class="op">$</span><span class="va">msLevel</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1 1</span></span></code></pre>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Replace MS levels</span></span>
<span><span class="va">be</span><span class="op">$</span><span class="va">msLevel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3L</span>, <span class="fl">2L</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#' Values after replacement</span></span>
<span><span class="va">be</span><span class="op">$</span><span class="va">msLevel</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 3 2</span></span></code></pre>
<p>We can also add a new chromatogram variables:</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Add a new chromatogram variable</span></span>
<span><span class="va">be</span><span class="op">$</span><span class="va">name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span></span>
<span><span class="va">be</span><span class="op">$</span><span class="va">name</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "A" "B"</span></span></code></pre>
<p>Or also replace intensity values. Below we replace the intensity
values by adding a value of +3 to each.</p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Replace intensity values</span></span>
<span><span class="va">be</span><span class="op">$</span><span class="va">msLevel3</span> <span class="op">&lt;-</span> <span class="va">be</span><span class="op">$</span><span class="va">msLevel</span> <span class="op">+</span> <span class="fl">3</span></span>
<span><span class="va">be</span><span class="op">$</span><span class="va">msLevel3</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 6 5</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="peaksdata-">
<code>peaksData&lt;-</code><a class="anchor" aria-label="anchor" href="#peaksdata-"></a>
</h4>
<p>The <code>peaksData&lt;-</code> method should allow to replace the
full peaks data (retention time and intensity value pairs) of all
chromatograms in a backend. As <code>value</code>, a <code>list</code>
of <code>data.frame</code> should be provided with columns names
<code>"rtime"</code> and <code>"intensity"</code>. Because the full
peaks data is provided at once, this method can (and should) support
changing also the number of peaks per chromatogram (while the methods
like <code>rtime&lt;-</code> or <code>$rtime</code> would not
allow).</p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' replacement method for peaks data</span></span>
<span><span class="fu">setReplaceMethod</span><span class="op">(</span><span class="st">"peaksData"</span>, <span class="st">"ChromBackendTest"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">object</span>, <span class="va">value</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">is.list</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"'value' is expected to be a list"</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">!=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"'value' has to be a list with "</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span>, <span class="st">" elements"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/hidden_aliases.html">validPeaksData</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span></span>
<span>  <span class="va">object</span><span class="op">@</span><span class="va">peaksData</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span>  <span class="va">object</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>With this method we can now replace the peaks data of a backend:</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Create a list with peaks matrices; our backend has 3 chromatograms</span></span>
<span><span class="co">#' thus our `list` has to be of length 3</span></span>
<span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>rtime <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12.3</span>, <span class="fl">14.4</span>, <span class="fl">15.4</span>, <span class="fl">16.4</span><span class="op">)</span>,</span>
<span>          intensity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">312</span>, <span class="fl">354.1</span>, <span class="fl">232</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>rtime <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">14.4</span><span class="op">)</span>,</span>
<span>          intensity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">13.4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">be_2</span> <span class="op">&lt;-</span> <span class="va">be</span></span>
<span><span class="co">#' Assign this peaks data to one of our test backends</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/peaksData.html" class="external-link">peaksData</a></span><span class="op">(</span><span class="va">be_2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">tmp</span></span>
<span></span>
<span><span class="co">#' Evaluate that we properly added the peaks data</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/peaksData.html" class="external-link">peaksData</a></span><span class="op">(</span><span class="va">be_2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [[1]]</span></span>
<span><span class="co">##   rtime intensity</span></span>
<span><span class="co">## 1  12.3     200.0</span></span>
<span><span class="co">## 2  14.4     312.0</span></span>
<span><span class="co">## 3  15.4     354.1</span></span>
<span><span class="co">## 4  16.4     232.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[2]]</span></span>
<span><span class="co">##   rtime intensity</span></span>
<span><span class="co">## 1  14.4      13.4</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="methods-with-available-default-implementations">Methods with available default implementations<a class="anchor" aria-label="anchor" href="#methods-with-available-default-implementations"></a>
</h3>
<p>Default implementations for the <code>ChromBackend</code> class are
available for a large number of methods. Thus, any backend extending
this class will automatically inherit these default implementations.
Alternative, class-specific, versions can, but don’t need to be
developed. The default versions are defined in the
<em>R/ChromBackend.R</em> file, and also listed in this section. If
alternative versions are implemented it should be ensured that the
expected data type is always used for core chromatogram variables. Use
<code><a href="../reference/ChromBackend.html">coreChromVariables()</a></code> and <code><a href="../reference/ChromBackend.html">corePeaksVariables()</a></code>
to list these mandatory data types.</p>
<div class="section level4">
<h4 id="backendparallelfactor">
<code>backendParallelFactor()</code><a class="anchor" aria-label="anchor" href="#backendparallelfactor"></a>
</h4>
<p>The <code><a href="https://rdrr.io/pkg/ProtGenerics/man/backendInitialize.html" class="external-link">backendParallelFactor()</a></code> function allows a backend to
suggest a preferred way it could be split for parallel processing. The
default implementation returns <code><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor()</a></code> (i.e. a
<code>factor</code> of length 0) hence not suggesting any specific
splitting setup.</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Is there a specific way how the object could be best split for</span></span>
<span><span class="co">#' parallel processing?</span></span>
<span><span class="kw">setMethod</span><span class="op">(</span><span class="st">"backendParallelFactor"</span>, <span class="st">"ChromBackend"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/backendInitialize.html" class="external-link">backendParallelFactor</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## factor()</span></span>
<span><span class="co">## Levels:</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="chromindex">
<code>chromIndex()</code><a class="anchor" aria-label="anchor" href="#chromindex"></a>
</h4>
<p>The <code><a href="../reference/chromData.html">chromIndex()</a></code> function should return the value for
the <code>"chromIndex"</code> chromatogram variable. As a result, an
<code>integer</code> of length equal to the number of chromatograms in
<code>object</code> needs to be returned. The default implementation
is:</p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' get the values for the chromIndex chromatogram variable</span></span>
<span><span class="kw">setMethod</span><span class="op">(</span><span class="st">"chromIndex"</span>, <span class="st">"ChromBackend"</span>,</span>
<span>          <span class="kw">function</span><span class="op">(</span><span class="va">object</span>, <span class="va">columns</span> <span class="op">=</span> <span class="fu"><a href="../reference/chromData.html">chromVariables</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>              <span class="fu"><a href="../reference/chromData.html">chromData</a></span><span class="op">(</span><span class="va">object</span>, columns <span class="op">=</span> <span class="st">"chromIndex"</span>, drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>          <span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>The result of calling this method on our test backend:</p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/chromData.html">chromIndex</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] NA NA</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="collisionenergy">
<code>collisionEnergy()</code><a class="anchor" aria-label="anchor" href="#collisionenergy"></a>
</h4>
<p>The <code><a href="../reference/chromData.html">collisionEnergy()</a></code> function should return the value
for the <code>"collisionEnergy"</code> chromatogram variable. As a
result, a <code>numeric</code> of length equal to the number of
chromatograms has to be returned. The default implementation is:</p>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' get the values for the collisionEnergy chromatogram variable</span></span>
<span><span class="kw">setMethod</span><span class="op">(</span><span class="st">"collisionEnergy"</span>, <span class="st">"ChromBackend"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/chromData.html">chromData</a></span><span class="op">(</span><span class="va">object</span>, columns <span class="op">=</span> <span class="st">"collisionEnergy"</span>, drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>The result of calling this method on our test backend:</p>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/chromData.html">collisionEnergy</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] NA NA</span></span></code></pre>
<p>The default replacement method for the <code>collisionEnergy</code>
chromatogram variable is:</p>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Default replacement method for collisionEnergy</span></span>
<span><span class="fu">setReplaceMethod</span><span class="op">(</span></span>
<span>    <span class="st">"collisionEnergy"</span>, <span class="st">"ChromBackend"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">object</span>, <span class="va">value</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">object</span><span class="op">$</span><span class="va">collisionEnergy</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span>    <span class="va">object</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>This method thus makes use of the <code>$&lt;-</code> replacement
method we implemented above. To test this function we replace the
collision energy below.</p>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Replace the collision energy</span></span>
<span><span class="fu"><a href="../reference/chromData.html">collisionEnergy</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">30</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/chromData.html">collisionEnergy</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 20 30</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="dataorigin-dataorigin-">
<code>dataOrigin()</code>, <code>dataOrigin&lt;-</code><a class="anchor" aria-label="anchor" href="#dataorigin-dataorigin-"></a>
</h4>
<p>The <code><a href="../reference/chromData.html">dataOrigin()</a></code> and <code>dataOrigin&lt;-</code>
methods return or set the value(s) for the <code>"dataOrigin"</code>
chromatogram variable. The values for this chromatogram variable need to
be of type <code>character</code> (the length equal to the number of
chromatograms). The default implementation for <code><a href="../reference/chromData.html">dataOrigin()</a></code>
is:</p>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Default implementation to access dataOrigin</span></span>
<span><span class="kw">setMethod</span><span class="op">(</span><span class="st">"dataOrigin"</span>, <span class="st">"ChromBackend"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/chromData.html">chromData</a></span><span class="op">(</span><span class="va">object</span>, columns <span class="op">=</span> <span class="st">"dataOrigin"</span>, drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>Below we use this method to access the values of the
<code>dataOrigin</code> chromatogram variable.</p>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Access the dataOrigin values</span></span>
<span><span class="fu"><a href="../reference/chromData.html">dataOrigin</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "&lt;user provided&gt;" "&lt;user provided&gt;"</span></span></code></pre>
<p>The default implementation for <code>dataOrigin&lt;-</code> uses,
like all defaults for replacement methods, the <code>$&lt;-</code>
method:</p>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Default implementation of the `dataOrigin&lt;-` replacement method</span></span>
<span><span class="fu">setReplaceMethod</span><span class="op">(</span><span class="st">"dataOrigin"</span>, <span class="st">"ChromBackend"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">object</span>, <span class="va">value</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">object</span><span class="op">$</span><span class="va">dataOrigin</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span>  <span class="va">object</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>For our backend we can change the values of the
<code>dataOrigin</code> variable:</p>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Replace the backend's dataOrigin values</span></span>
<span><span class="fu"><a href="../reference/chromData.html">dataOrigin</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"from somewhere"</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/chromData.html">dataOrigin</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "from somewhere" "from somewhere"</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="datastorage-datastorage-">
<code>dataStorage()</code>, <code>dataStorage&lt;-</code><a class="anchor" aria-label="anchor" href="#datastorage-datastorage-"></a>
</h4>
<p>Similarly, the <code><a href="../reference/chromData.html">dataStorage()</a></code> and
<code>dataStorage&lt;-</code> methods should allow to get or set the
data storage chromatogram variable. Values of the
<code>dataStorage</code> chromatogram variable are expected to be of
type <code>character</code> and for each chromatogram in a backend one
value needs to be defined (which can not be <code>NA_character</code>).
The default implementation for <code><a href="../reference/chromData.html">dataStorage()</a></code> uses, like
most access methods, the <code><a href="../reference/chromData.html">chromData()</a></code> function:</p>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Default implementation to access dataStorage</span></span>
<span><span class="kw">setMethod</span><span class="op">(</span><span class="st">"dataStorage"</span>, <span class="st">"ChromBackend"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/chromData.html">chromData</a></span><span class="op">(</span><span class="va">object</span>, columns <span class="op">=</span> <span class="st">"dataStorage"</span>, drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>Below we use this method to access the values of the
<code>dataStorage</code> chromatogram variable.</p>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Access the dataStorage values</span></span>
<span><span class="fu"><a href="../reference/chromData.html">dataStorage</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "&lt;memory&gt;" "&lt;memory&gt;"</span></span></code></pre>
<p>Note that this variable is supposed to provide information on the
location where the data is stored and hence for some type of backends it
might not be possible or advised to let the user change its values. For
such backends a <code>dataStorage&lt;-</code> replacement method should
be implemented specifically that throws an error if values are replaced
with eventually invalid values. The default implementation for this
method uses, like all defaults for replacement methods, the
<code>$&lt;-</code> method:</p>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Default implementation of the `dataStorage&lt;-` replacement method</span></span>
<span><span class="fu">setReplaceMethod</span><span class="op">(</span><span class="st">"dataStorage"</span>, <span class="st">"ChromBackend"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">object</span>, <span class="va">value</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">object</span><span class="op">$</span><span class="va">dataStorage</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span>  <span class="va">object</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>For our backend we can change the values of the
<code>dataStorage</code> variable:</p>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Replace the backend's datastorage values</span></span>
<span><span class="fu"><a href="../reference/chromData.html">dataStorage</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"here"</span>, <span class="st">"here"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/chromData.html">dataStorage</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "here" "here"</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="intensity-intensity-">
<code>intensity()</code>, <code>intensity&lt;-</code><a class="anchor" aria-label="anchor" href="#intensity-intensity-"></a>
</h4>
<p>The <code><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">intensity()</a></code> and <code>intensity&lt;-</code> methods
allow to extract or set the intensity values of the individual
chromatograms represented by the backend. The default for the
<code><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">intensity()</a></code> function, which is expected to return a
<code>list</code> of <code>numeric</code> values with the intensity
values of each chromatogram, uses the <code><a href="https://rdrr.io/pkg/ProtGenerics/man/peaksData.html" class="external-link">peaksData()</a></code>
method:</p>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Default method to extract intensity values</span></span>
<span><span class="kw">setMethod</span><span class="op">(</span><span class="st">"intensity"</span>, <span class="st">"ChromBackend"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/peaksData.html" class="external-link">peaksData</a></span><span class="op">(</span><span class="va">object</span>, column <span class="op">=</span> <span class="st">"intensity"</span>, drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>The default replacement method for intensity values uses the
<code>$&lt;-</code> method:</p>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Default implementation of the replacement method for intensity values</span></span>
<span><span class="fu">setReplaceMethod</span><span class="op">(</span><span class="st">"intensity"</span>, <span class="st">"ChromBackend"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">object</span>, <span class="va">value</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">pd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/peaksData.html" class="external-link">peaksData</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">is.list</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span> <span class="op">||</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">pd</span><span class="op">)</span> <span class="op">!=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"'value' should be a list of the same length as 'object'"</span><span class="op">)</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">pd</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">value</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">!=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">pd</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Length of 'value[["</span>, <span class="va">i</span>, <span class="st">"]]' does not match "</span>,</span>
<span>                       <span class="st">"the number of rows in the intensity of chromatogram: "</span>,</span>
<span>                       <span class="va">i</span>, <span class="st">"'"</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/peaksData.html" class="external-link">peaksData</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">pd</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">pd</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">intensity</span> <span class="op">&lt;-</span> <span class="va">value</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">pd</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span>    <span class="va">object</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Replace intensity values</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">intensity</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">intensity</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="fl">10</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">intensity</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [[1]]</span></span>
<span><span class="co">## [1]  133.3  163.6 2364.3  253.4</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[2]]</span></span>
<span><span class="co">## [1] 100.0  80.1</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="isempty">
<code>isEmpty()</code><a class="anchor" aria-label="anchor" href="#isempty"></a>
</h4>
<p>The <code>isEmpty()</code> is a simple helper function to evaluate
whether chromatograms are <em>empty</em>, i.e. have no peaks (retention
time and intensity values). It should return a logical vector of length
equal to the number of chromatograms in the backend with
<code>TRUE</code> if a chromatogram is empty and <code>FALSE</code>
otherwise. The default implementation uses the <code><a href="https://rdrr.io/r/base/lengths.html" class="external-link">lengths()</a></code>
method (defined further below) that returns for each chromatogram the
number of available data points (peaks).</p>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Default implementation for `isEmpty()`</span></span>
<span><span class="kw">setMethod</span><span class="op">(</span><span class="st">"isEmpty"</span>, <span class="st">"ChromBackend"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/lengths.html" class="external-link">lengths</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0L</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">isEmpty</span><span class="op">(</span><span class="va">be</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] FALSE FALSE</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="isreadonly">
<code>isReadOnly()</code><a class="anchor" aria-label="anchor" href="#isreadonly"></a>
</h4>
<p>As discussed above, backends can also be <em>read-only</em>, hence
only allowing to access, but not to change any values (e.g. if the data
is stored in a data base and the connection to this data base does not
support updating or replacing data). In such cases, the default
<code><a href="https://rdrr.io/pkg/ProtGenerics/man/backendInitialize.html" class="external-link">isReadOnly()</a></code> method can be used, which returns always
<code>TRUE</code>:</p>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Default implementation of `isReadOnly()`</span></span>
<span><span class="kw">setMethod</span><span class="op">(</span><span class="st">"isReadOnly"</span>, <span class="st">"ChromBackend"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="cn">TRUE</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>Backends that support changing data values should implement their own
version (like we did above) to return <code>FALSE</code> instead:</p>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/backendInitialize.html" class="external-link">isReadOnly</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] FALSE</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="length-1">
<code>length()</code><a class="anchor" aria-label="anchor" href="#length-1"></a>
</h4>
<p>The <code><a href="https://rdrr.io/r/base/length.html" class="external-link">length()</a></code> method should return a single
<code>integer</code> with the total number of chromatograms available
through the backend. The default implementation for this function
is:</p>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Default implementation for `length()`</span></span>
<span><span class="kw">setMethod</span><span class="op">(</span><span class="st">"length"</span>, <span class="st">"ChromBackend"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="fu"><a href="../reference/chromData.html">chromData</a></span><span class="op">(</span><span class="va">x</span>, columns <span class="op">=</span> <span class="st">"dataStorage"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 2</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="lengths">
<code>lengths()</code><a class="anchor" aria-label="anchor" href="#lengths"></a>
</h4>
<p>The <code><a href="https://rdrr.io/r/base/lengths.html" class="external-link">lengths()</a></code> function should return the number of data
pairs (peaks; retention time or intensity values) per chromatogram. The
result should be an <code>integer</code> vector (of length equal to the
number of chromatograms in the backend) with these counts. The default
implementation uses the <code><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">intensity()</a></code> function.</p>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Default implementation for `lengths()`</span></span>
<span><span class="kw">setMethod</span><span class="op">(</span><span class="st">"lengths"</span>, <span class="st">"ChromBackend"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/lengths.html" class="external-link">lengths</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">intensity</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>The number of peaks for our test backend:</p>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/lengths.html" class="external-link">lengths</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 4 2</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="mslevel-mslevel-">
<code>msLevel()</code>, <code>msLevel&lt;-</code><a class="anchor" aria-label="anchor" href="#mslevel-mslevel-"></a>
</h4>
<p>The <code><a href="../reference/chromData.html">msLevel()</a></code> and <code>msLevel&lt;-</code> methods
should allow extracting and setting the MS level for the individual
chromatograms. MS levels are encoded as <code>integer</code>, thus,
<code><a href="../reference/chromData.html">msLevel()</a></code> must return an <code>integer</code> vector of
length equal to the number of chromatograms of the backend and
<code>msLevel&lt;-</code> should take/accept such a vector as input. The
default implementations for both methods are shown below.</p>
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Default methods to get or set MS levels</span></span>
<span><span class="kw">setMethod</span><span class="op">(</span><span class="st">"msLevel"</span>, <span class="st">"ChromBackend"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/chromData.html">chromData</a></span><span class="op">(</span><span class="va">object</span>, columns <span class="op">=</span> <span class="st">"msLevel"</span>, drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu">setReplaceMethod</span><span class="op">(</span><span class="st">"msLevel"</span>, <span class="st">"ChromBackend"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">object</span>, <span class="va">value</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">object</span><span class="op">$</span><span class="va">msLevel</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span>    <span class="va">object</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>To test these we below replace the MS levels for our test data set
and extract these values again.</p>
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/chromData.html">msLevel</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">2L</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/chromData.html">msLevel</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1 2</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="mz-mz-">
<code>mz()</code>, <code>mz&lt;-</code><a class="anchor" aria-label="anchor" href="#mz-mz-"></a>
</h4>
<p>The <code><a href="../reference/chromData.html">mz()</a></code> and <code>mz&lt;-</code> methods should allow
to extract or set the m/z value for each chromatogram. The m/z value of
a chromatogram is encoded as <code>numeric</code>, thus, the methods are
expected to return or accept a <code>numeric</code> vector of length
equal to the number of chromatograms. The default implementations are
shown below.</p>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Default implementations to get or set m/z value(s)</span></span>
<span><span class="kw">setMethod</span><span class="op">(</span><span class="st">"mz"</span>, <span class="st">"ChromBackend"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/chromData.html">chromData</a></span><span class="op">(</span><span class="va">object</span>, columns <span class="op">=</span> <span class="st">"mz"</span>, drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu">setReplaceMethod</span><span class="op">(</span><span class="st">"mz"</span>, <span class="st">"ChromBackend"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">object</span>, <span class="va">value</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">object</span><span class="op">$</span><span class="va">mz</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span>    <span class="va">object</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>We below set and extract these <em>target</em> m/z values.</p>
<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/chromData.html">mz</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">314.3</span>, <span class="fl">312.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/chromData.html">mz</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 314.3 312.5</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="mzmax-mzmax-">
<code>mzMax()</code>, <code>mzMax&lt;-</code><a class="anchor" aria-label="anchor" href="#mzmax-mzmax-"></a>
</h4>
<p>The <code><a href="../reference/chromData.html">mzMax()</a></code> and <code>mzMax&lt;-</code> methods should
allow to extract or set the upper m/z boundary for each chromatogram.
m/z values are encoded as <code>numeric</code>, thus, the methods are
expected to return or accept a <code>numeric</code> vector of length
equal to the number of chromatograms. The default implementations are
shown below.</p>
<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Default implementations to get or set upper m/z limits</span></span>
<span><span class="kw">setMethod</span><span class="op">(</span><span class="st">"mzMax"</span>, <span class="st">"ChromBackend"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/chromData.html">chromData</a></span><span class="op">(</span><span class="va">object</span>, columns <span class="op">=</span> <span class="st">"mzMax"</span>, drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu">setReplaceMethod</span><span class="op">(</span><span class="st">"mzMax"</span>, <span class="st">"ChromBackend"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">object</span>, <span class="va">value</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">object</span><span class="op">$</span><span class="va">mzMax</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span>    <span class="va">object</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>Testing these functions by replacing the upper m/z boundary with new
values.</p>
<div class="sourceCode" id="cb121"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/chromData.html">mzMax</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/chromData.html">mz</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.01</span></span>
<span><span class="fu"><a href="../reference/chromData.html">mzMax</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 314.31 312.51</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="mzminmzmin-">
<code>mzMin(),</code>mzMin&lt;-`<a class="anchor" aria-label="anchor" href="#mzminmzmin-"></a>
</h4>
<p>The <code><a href="../reference/chromData.html">mzMin()</a></code> and <code>mzMin&lt;-</code> methods should
allow to extract or set the lower m/z boundary for each chromatogram.
m/z values are encoded as <code>numeric</code>, thus, the methods are
expected to return or accept a <code>numeric</code> vector of length
equal to the number of chromatograms. The default implementations are
shown below.</p>
<div class="sourceCode" id="cb123"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Default methods to get or set the lower m/z boundary</span></span>
<span><span class="kw">setMethod</span><span class="op">(</span><span class="st">"mzMin"</span>, <span class="st">"ChromBackend"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/chromData.html">chromData</a></span><span class="op">(</span><span class="va">object</span>, columns <span class="op">=</span> <span class="st">"mzMin"</span>, drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">setReplaceMethod</span><span class="op">(</span><span class="st">"mzMin"</span>, <span class="st">"ChromBackend"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">object</span>, <span class="va">value</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">object</span><span class="op">$</span><span class="va">mzMin</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span>  <span class="va">object</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>Testing these functions by replacing the lower m/z boundary with new
values.</p>
<div class="sourceCode" id="cb124"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/chromData.html">mzMin</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/chromData.html">mz</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span> <span class="op">-</span> <span class="fl">0.01</span></span>
<span><span class="fu"><a href="../reference/chromData.html">mzMin</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 314.29 312.49</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="precursormz-precursormz-">
<code>precursorMz()</code>, <code>precursorMz&lt;-</code><a class="anchor" aria-label="anchor" href="#precursormz-precursormz-"></a>
</h4>
<p>The <code><a href="../reference/chromData.html">precursorMz()</a></code> and <code>precursorMz&lt;-</code>
methods are expected to get or set the values for the precursor m/z of
each chromatogram (if available). These are encoded as
<code>numeric</code> (one value per chromatogram) - and if a value is
not available <code>NA_real_</code> should be returned. The default
implementations are:</p>
<div class="sourceCode" id="cb126"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Default implementations to get or set the precursorMz chrom variable</span></span>
<span><span class="kw">setMethod</span><span class="op">(</span><span class="st">"precursorMz"</span>, <span class="st">"ChromBackend"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/chromData.html">chromData</a></span><span class="op">(</span><span class="va">object</span>, columns <span class="op">=</span> <span class="st">"precursorMz"</span>, drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu">setReplaceMethod</span><span class="op">(</span><span class="st">"precursorMz"</span>, <span class="st">"ChromBackend"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">object</span>, <span class="va">value</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">object</span><span class="op">$</span><span class="va">precursorMz</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span>    <span class="va">object</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>Below we set and get the <code>precursorMz</code> chromatogram
variable for our backend.</p>
<div class="sourceCode" id="cb127"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/chromData.html">precursorMz</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA_real_</span>, <span class="fl">123.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/chromData.html">precursorMz</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1]    NA 123.3</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="precursormzmax-precursormzmax-">
<code>precursorMzMax()</code>, <code>precursorMzMax&lt;-</code><a class="anchor" aria-label="anchor" href="#precursormzmax-precursormzmax-"></a>
</h4>
<p>These methods are supposed to allow to get and set the
<code>precursorMzMax</code> chromatogram variable. The default
implementations are:</p>
<div class="sourceCode" id="cb129"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Default implementations for `precursorMzMax`</span></span>
<span><span class="kw">setMethod</span><span class="op">(</span><span class="st">"precursorMzMax"</span>, <span class="st">"ChromBackend"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/chromData.html">chromData</a></span><span class="op">(</span><span class="va">object</span>, columns <span class="op">=</span> <span class="st">"precursorMzMax"</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu">setReplaceMethod</span><span class="op">(</span><span class="st">"precursorMzMax"</span>, <span class="st">"ChromBackend"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">object</span>, <span class="va">value</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">object</span><span class="op">$</span><span class="va">precursorMzMax</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span>    <span class="va">object</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>Below we test these functions by setting and extracting the values
for this chromatogram variable.</p>
<div class="sourceCode" id="cb130"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/chromData.html">precursorMzMax</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/chromData.html">precursorMz</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.1</span></span>
<span><span class="fu"><a href="../reference/chromData.html">precursorMzMax</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1]    NA 123.4</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="precursormzmin-precursormzmin-">
<code>precursorMzMin()</code>, <code>precursorMzMin&lt;-</code><a class="anchor" aria-label="anchor" href="#precursormzmin-precursormzmin-"></a>
</h4>
<p>These methods are supposed to allow to get and set the
<code>precursorMzMin</code> chromatogram variable. The default
implementations are:</p>
<div class="sourceCode" id="cb132"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Default implementations for `precursorMzMin`</span></span>
<span><span class="kw">setMethod</span><span class="op">(</span><span class="st">"precursorMzMin"</span>, <span class="st">"ChromBackend"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/chromData.html">chromData</a></span><span class="op">(</span><span class="va">object</span>, columns <span class="op">=</span> <span class="st">"precursorMzMin"</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu">setReplaceMethod</span><span class="op">(</span><span class="st">"precursorMzMin"</span>, <span class="st">"ChromBackend"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">object</span>, <span class="va">value</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">object</span><span class="op">$</span><span class="va">precursorMzMin</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span>    <span class="va">object</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>Below we test these functions by setting and extracting the values
for this chromatogram variable.</p>
<div class="sourceCode" id="cb133"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/chromData.html">precursorMzMin</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/chromData.html">precursorMz</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span> <span class="op">-</span> <span class="fl">0.1</span></span>
<span><span class="fu"><a href="../reference/chromData.html">precursorMzMin</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1]    NA 123.2</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="productmz-productmz-">
<code>productMz()</code>, <code>productMz&lt;-</code><a class="anchor" aria-label="anchor" href="#productmz-productmz-"></a>
</h4>
<p>These methods are supposed to allow to get and set the
<code>productMz</code> chromatogram variable. The default
implementations are:</p>
<div class="sourceCode" id="cb135"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Default implementations for `productMz`</span></span>
<span><span class="kw">setMethod</span><span class="op">(</span><span class="st">"productMz"</span>, <span class="st">"ChromBackend"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/chromData.html">chromData</a></span><span class="op">(</span><span class="va">object</span>, columns <span class="op">=</span> <span class="st">"productMz"</span>, drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu">setReplaceMethod</span><span class="op">(</span><span class="st">"productMz"</span>, <span class="st">"ChromBackend"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">object</span>, <span class="va">value</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">object</span><span class="op">$</span><span class="va">productMz</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span>    <span class="va">object</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>Below we test these functions by setting and extracting the values
for this chromatogram variable.</p>
<div class="sourceCode" id="cb136"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/chromData.html">productMz</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">123.2</span>, <span class="cn">NA_real_</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/chromData.html">productMz</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 123.2    NA</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="productmzmax-productmzmax-">
<code>productMzMax()</code>, <code>productMzMax&lt;-</code><a class="anchor" aria-label="anchor" href="#productmzmax-productmzmax-"></a>
</h4>
<p>These methods are supposed to allow to get and set the
<code>productMzMax</code> chromatogram variable. The default
implementations are:</p>
<div class="sourceCode" id="cb138"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Default implementations for `productMzMax`</span></span>
<span><span class="kw">setMethod</span><span class="op">(</span><span class="st">"productMzMax"</span>, <span class="st">"ChromBackend"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/chromData.html">chromData</a></span><span class="op">(</span><span class="va">object</span>, columns <span class="op">=</span> <span class="st">"productMzMax"</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu">setReplaceMethod</span><span class="op">(</span><span class="st">"productMzMax"</span>, <span class="st">"ChromBackend"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">object</span>, <span class="va">value</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">object</span><span class="op">$</span><span class="va">productMzMax</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span>    <span class="va">object</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>Below we test these functions by setting and extracting the values
for this chromatogram variable.</p>
<div class="sourceCode" id="cb139"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/chromData.html">productMzMax</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/chromData.html">productMz</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.02</span></span>
<span><span class="fu"><a href="../reference/chromData.html">productMzMax</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 123.22     NA</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="productmzmin-productmzmin-">
<code>productMzMin()</code>, <code>productMzMin&lt;-</code><a class="anchor" aria-label="anchor" href="#productmzmin-productmzmin-"></a>
</h4>
<p>These methods are supposed to allow to get and set the
<code>productMzMin</code> chromatogram variable. The default
implementations are:</p>
<div class="sourceCode" id="cb141"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Default implementations for `productMzMin`</span></span>
<span><span class="kw">setMethod</span><span class="op">(</span><span class="st">"productMzMin"</span>, <span class="st">"ChromBackend"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/chromData.html">chromData</a></span><span class="op">(</span><span class="va">object</span>, columns <span class="op">=</span> <span class="st">"productMzMin"</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu">setReplaceMethod</span><span class="op">(</span><span class="st">"productMzMin"</span>, <span class="st">"ChromBackend"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">object</span>, <span class="va">value</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">object</span><span class="op">$</span><span class="va">productMzMin</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span>    <span class="va">object</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>Below we test these functions by setting and extracting the values
for this chromatogram variable.</p>
<div class="sourceCode" id="cb142"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/chromData.html">productMzMin</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/chromData.html">productMz</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span> <span class="op">-</span> <span class="fl">0.2</span></span>
<span><span class="fu"><a href="../reference/chromData.html">productMzMin</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 123  NA</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="rtime-rtime-">
<code>rtime()</code>, <code>rtime&lt;-</code><a class="anchor" aria-label="anchor" href="#rtime-rtime-"></a>
</h4>
<p>The <code><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">rtime()</a></code> and <code>rtime&lt;-</code> methods allow to
get and set the retention times of the individual chromatograms of the
backend. Similar to the method for the intensity values described above
they should return or accept a <code>NumericList</code>, each element
being a <code>numeric</code> vector with the retention time values of
one chromatogram. The default implementations of these methods are shown
below.</p>
<div class="sourceCode" id="cb144"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Default methods for `rtime()` and `rtime&lt;-`</span></span>
<span><span class="kw">setMethod</span><span class="op">(</span><span class="st">"rtime"</span>, <span class="st">"ChromBackend"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">{</span>    </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/peaksData.html" class="external-link">peaksData</a></span><span class="op">(</span><span class="va">object</span>, column <span class="op">=</span> <span class="st">"rtime"</span>, drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">setReplaceMethod</span><span class="op">(</span><span class="st">"rtime"</span>, <span class="st">"ChromBackend"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">object</span>, <span class="va">value</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">pd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/peaksData.html" class="external-link">peaksData</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">is.list</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span> <span class="op">||</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">pd</span><span class="op">)</span> <span class="op">!=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"'value' should be a list of the same length as 'object'"</span><span class="op">)</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">pd</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">value</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">!=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">pd</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Length of 'value[["</span>, <span class="va">i</span>, <span class="st">"]]' does not match "</span>,</span>
<span>            <span class="st">"the number of rows in 'the rtime of chromatogram: "</span>, <span class="va">i</span>, <span class="st">"'"</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/peaksData.html" class="external-link">peaksData</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">pd</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">pd</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">rtime</span> <span class="op">&lt;-</span> <span class="va">value</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">pd</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span>    <span class="va">object</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>We below test this implementation replacing the retention times of
our example backend by shifting all values by 2 seconds.</p>
<div class="sourceCode" id="cb145"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">rtime</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">rtime</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="fl">2</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">rtime</a></span><span class="op">(</span><span class="va">be</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [[1]]</span></span>
<span><span class="co">## [1] 14.4 14.8 15.2 16.6</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[2]]</span></span>
<span><span class="co">## [1] 45.1 46.2</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="split">
<code>split()</code><a class="anchor" aria-label="anchor" href="#split"></a>
</h4>
<p>The <code><a href="https://rdrr.io/r/base/split.html" class="external-link">split()</a></code> method should split the backend into a
<code>list</code> of backends containing subsets of the original
backend. The default implementation uses the default implementation of
<code><a href="https://rdrr.io/r/base/split.html" class="external-link">split()</a></code> from R and should work in most cases. This function
uses the <code>[</code> method to subset/split the object.</p>
<div class="sourceCode" id="cb147"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Default method to split a backend</span></span>
<span><span class="kw">setMethod</span><span class="op">(</span><span class="st">"split"</span>, <span class="st">"ChromBackend"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">f</span>, <span class="va">drop</span> <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split.default</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">f</span>, drop <span class="op">=</span> <span class="va">drop</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>We below test this by splitting the backend into two subsets.</p>
<div class="sourceCode" id="cb148"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">be</span>, f <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in split.default(x, f, drop = drop, ...): data length is not a multiple</span></span>
<span><span class="co">## of split variable</span></span></code></pre>
<pre><code><span><span class="co">## $`1`</span></span>
<span><span class="co">## ChromBackendTest with 1 chromatograms</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $`2`</span></span>
<span><span class="co">## ChromBackendTest with 1 chromatograms</span></span></code></pre>
</div>
</div>
</div>
<div class="section level2">
<h2 id="session-information">Session information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<div class="sourceCode" id="cb151"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.4.2 (2024-10-31)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">## Running under: Ubuntu 24.04.1 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span><span class="co">##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co">## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: UTC</span></span>
<span><span class="co">## tzcode source: system (glibc)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] Chromatograms_0.3.0 ProtGenerics_1.39.1 BiocStyle_2.34.0   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] cli_3.6.3           knitr_1.49          rlang_1.1.4        </span></span>
<span><span class="co">##  [4] xfun_0.49           textshaping_0.4.1   clue_0.3-66        </span></span>
<span><span class="co">##  [7] jsonlite_1.8.9      S4Vectors_0.44.0    htmltools_0.5.8.1  </span></span>
<span><span class="co">## [10] stats4_4.4.2        ragg_1.3.3          sass_0.4.9         </span></span>
<span><span class="co">## [13] rmarkdown_2.29      evaluate_1.0.1      jquerylib_0.1.4    </span></span>
<span><span class="co">## [16] MASS_7.3-64         fastmap_1.2.0       IRanges_2.40.1     </span></span>
<span><span class="co">## [19] yaml_2.3.10         lifecycle_1.0.4     bookdown_0.41      </span></span>
<span><span class="co">## [22] MsCoreUtils_1.18.0  BiocManager_1.30.25 cluster_2.1.8      </span></span>
<span><span class="co">## [25] compiler_4.4.2      fs_1.6.5            htmlwidgets_1.6.4  </span></span>
<span><span class="co">## [28] systemfonts_1.1.0   digest_0.6.37       R6_2.5.1           </span></span>
<span><span class="co">## [31] bslib_0.8.0         tools_4.4.2         BiocGenerics_0.52.0</span></span>
<span><span class="co">## [34] pkgdown_2.1.1.9000  cachem_1.1.0        desc_1.4.3</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Laurent Gatto, Johannes Rainer, Philippine Louail.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

      </footer>
</div>






  </body>
</html>
